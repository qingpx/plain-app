import{d as E,aD as N,r as q,aE as j,cB as z,i as C,cC as R,cD as H,M as k,o as m,x as r,j as v,J as f,t as i,k as o,aG as y,an as J,C as O,a as p,O as X,R as b,c as Y,a1 as x,cE as K,a0 as P,cF as U,au as W,aI as Z,a7 as h,bX as ee,L as ae,u as $,Y as te,bo as se,H as D,a5 as oe}from"./index-DK2k7uUz.js";const ne={class:"button-group"},le=E({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(d){const{handleSubmit:_}=N(),t=q("add_to_tags"),a=d,{value:s,errorMessage:n}=j("selectedTags",z().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:l,loading:g,onDone:M}=C({document:R}),{mutate:A,loading:F,onDone:L}=C({document:H}),T=()=>{h.emit("items_tags_updated",{type:a.type}),h.emit("refetch_tags",a.type),y()};L(T),M(T);function S(e){s.value.includes(e)?ee(s.value,u=>u.id===e.id):s.value.push(e)}const B=_(()=>{t.value==="add_to_tags"?A({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query}):l({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query})});return(e,u)=>{const I=K,G=U,Q=J,V=O,w=Z;return m(),k(w,{onClose:o(y)},{headline:r(()=>[f(i(e.$t("tags")),1)]),content:r(()=>[p("div",ne,[p("button",{class:b({selected:t.value==="add_to_tags"}),onClick:u[0]||(u[0]=c=>t.value="add_to_tags")},i(e.$t("add_to_tags")),3),p("button",{class:b({selected:t.value==="remove_from_tags"}),onClick:u[1]||(u[1]=c=>t.value="remove_from_tags")},i(e.$t("remove_from_tags")),3)]),v(G,null,{default:r(()=>[(m(!0),Y(P,null,x(d.tags,c=>(m(),k(I,{key:c.id,label:c.name,selected:o(s).includes(c),onClick:ue=>S(c)},null,8,["label","selected","onClick"]))),128))]),_:1}),X(p("div",{class:"invalid-feedback"},i(o(n)?e.$t(o(n)):""),513),[[W,o(n)]])]),actions:r(()=>[v(Q,{value:"cancel",onClick:o(y)},{default:r(()=>[f(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),v(V,{value:"save",loading:o(F)||o(g),onClick:o(B)},{default:r(()=>[f(i(e.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),de=ae(le,[["__scopeId","data-v-8725492b"]]),re=(d,_)=>{const{t}=$();return{addToTags:(a,s,n)=>{let l=n;if(!s){if(a.length===0){D(t("select_first"),"error");return}l=`ids:${a.join(",")}`}oe(de,{type:d,tags:_.value,query:l})}}},ie=(d,_=()=>{})=>{const t=q([]),{t:a}=$(),{loading:s,fetch:n}=te({handle:async(l,g)=>{g?D(a(g),"error"):l&&(t.value=l.tags,_())},document:se,variables:{type:d}});return{tags:t,loading:s,fetch:n}};export{re as a,ie as u};
