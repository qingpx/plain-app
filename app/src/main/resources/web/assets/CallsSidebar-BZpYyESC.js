import{_ as M}from"./LeftSidebar.vuevuetypescriptsetuptruelang-DPyKxbGb.js";import{_ as N}from"./TagFilter.vuevuetypescriptsetuptruelang-CppRCVEx.js";import{e as Q,f as V,s as z,g as A,T as D,r as d,W as R,w as H,ae as j,a5 as h,af as x,K as E,o as u,q as C,a6 as k,a4 as F,ag as G,a as s,k as K,c as _,z as S,O as $,j as B,t as a,l as L,$ as O,Z as P,H as U,C as W,B as T,D as Z}from"./index-FOZNDT71.js";import{u as J}from"./search-B2DXL489.js";import"./VDropdownMenu-C452vHO7.js";import"./more-vert-D-cJppqq.js";const X={class:"nav"},Y={class:"title"},ee={key:0,class:"count"},te=["onClick"],se={class:"title"},ae={key:0,class:"count"},de=Q({__name:"CallsSidebar",setup(oe){const m=V(),{counter:p}=z(A()),{parseQ:q}=J(),o=D({tagIds:[]}),n=d(""),l=d(""),c=d(new Map),{fetch:f}=R({handle:e=>{e&&(p.value.calls=e.total,c.value.set("1",e.incoming),c.value.set("2",e.outgoing),c.value.set("3",e.missed))},document:G,variables:()=>({})});function v(e){return c.value.get(e)??-1}function g(){var i;const e=k.currentRoute.value,r=F(((i=e.query.q)==null?void 0:i.toString())??"");q(o,r),n.value=o.type??"",l.value=o.tagIds.length===1?o.tagIds[0]:"",n.value&&(l.value=""),f()}g(),H(()=>k.currentRoute.value,()=>{g()});function w(e){const r=W([{name:"type",op:"",value:e}]);T(m,`/calls?q=${Z(r)}`)}function b(){T(m,"/calls")}const y=()=>{f()};return j(()=>{h.on("calls_deleted",y)}),x(()=>{h.off("calls_deleted",y)}),(e,r)=>{const i=N,I=M;return u(),E(I,null,{title:C(()=>[U(a(e.$t("page_title.calls")),1)]),body:C(()=>[s("ul",X,[s("li",{class:$({active:!l.value&&!n.value}),onClick:S(b,["prevent"])},[s("span",Y,a(e.$t("all")),1),L(p).calls>=0?(u(),_("span",ee,a(L(p).calls.toLocaleString()),1)):B("",!0)],2),(u(),_(P,null,O(["1","2","3"],t=>s("li",{key:t,class:$({active:t===n.value}),onClick:S(ne=>w(t),["prevent"])},[s("span",se,a(e.$t(`call_type.${t}`)),1),v(t)>=0?(u(),_("span",ae,a(v(t).toLocaleString()),1)):B("",!0)],10,te)),64))]),K(i,{type:"CALL",selected:l.value},null,8,["selected"])]),_:1})}}});export{de as default};
