import{_ as wo}from"./ListItemPhone.vuevuetypescriptsetuptruelang-C7UN6m3-.js";import{_ as $o}from"./more-vert-CmrhUssH.js";import{e as Q,r as L,c as r,o,L as F,k as u,Z as O,M as le,K as b,G as Se,z as I,q as m,ak as ht,ah as Ve,a as v,t as _,a8 as yt,by as Do,j as P,J as ae,O as kt,bz as ce,l as i,aH as st,n as G,R as it,H as Y,S as lt,d as Co,m as me,bA as bt,bc as To,bB as Fo,$ as qe,f as It,T as wt,w as Ce,bC as qo,v as at,y as So,bD as Vo,A as Po,B as ue,bE as $t,bF as Eo,u as Bo,V as Lo,s as Te,g as Uo,an as Ao,aT as rt,bG as Mo,bH as Oo,bI as Ro,aO as zo,W as Ho,bJ as Ko,am as dt,i as ut,aw as jo,X as No,Y as Go,p as Qo,ap as Jo,aq as Wo,br as Xo,a0 as Yo,a2 as de,bK as ct,bL as Zo,F as W,bM as xo,bN as en,bO as tn,a5 as X,bP as on,bQ as mt,bR as pt,aY as ft,bS as vt,at as Fe,bT as _t,bU as nn,a4 as sn,bV as ln}from"./index-B_6OBIiz.js";import{_ as Dt,a as an}from"./upload-rounded-DB5CUbBQ.js";import{_ as rn}from"./FieldId.vuevuetypescriptsetuptruelang-PGoLF1oK.js";import{_ as Ct}from"./VCheckbox-BMTfinLa.js";import{_ as dn,u as un,c as cn}from"./key-events-CkO8GMm9.js";import{_ as mn,a as pn}from"./search-rounded-B3UzLU8d.js";import{_ as fn}from"./content-paste-rounded-BwXBmV0N.js";const vn={class:"actions"},_n={class:"card card-info"},gn={class:"key-value vertical"},hn={class:"key"},yn={class:"value"},kn=Q({__name:"FileActionButtons",props:{item:{},canPaste:{type:Boolean}},emits:["downloadDir","downloadFile","uploadFiles","uploadDir","deleteItem","duplicateItem","cutItem","copyItem","pasteItem","copyLink","renameItem","addToFavorites"],setup(g,{emit:f}){const s=f,$=L(!1),y=L(!1),w=L(!1);function d(n){s("downloadDir",n)}function D(n){s("downloadFile",n)}function U(n){s("uploadFiles",n)}function A(n){s("uploadDir",n)}function C(n){s("deleteItem",n)}function h(n){s("duplicateItem",n)}function V(n){s("cutItem",n)}function H(n){s("copyItem",n)}function E(n){s("pasteItem",n)}function e(n){s("copyLink",n)}function l(n){s("renameItem",n)}function k(n){s("addToFavorites",n)}return(n,c)=>{const R=ht,q=Se,p=Dt,K=Ve,Z=yt,J=Do,M=$o,z=le("tooltip");return o(),r("div",vn,[n.item.isDir?(o(),r(O,{key:0},[F((o(),b(q,{class:"sm",onClick:c[0]||(c[0]=I(S=>d(n.item.path),["stop"]))},{default:m(()=>[u(R)]),_:1})),[[z,n.$t("download")]]),u(K,{modelValue:$.value,"onUpdate:modelValue":c[3]||(c[3]=S=>$.value=S)},{trigger:m(()=>[F((o(),b(q,{class:"sm"},{default:m(()=>[u(p)]),_:1})),[[z,n.$t("upload")]])]),default:m(()=>[v("div",{class:"dropdown-item",onClick:c[1]||(c[1]=I(S=>{U(n.item.path),$.value=!1},["stop"]))},_(n.$t("upload_files")),1),v("div",{class:"dropdown-item",onClick:c[2]||(c[2]=I(S=>{A(n.item.path),$.value=!1},["stop"]))},_(n.$t("upload_folder")),1)]),_:1},8,["modelValue"])],64)):F((o(),b(q,{key:1,class:"sm",onClick:c[4]||(c[4]=I(S=>D(n.item.path),["stop"]))},{default:m(()=>[u(R)]),_:1})),[[z,n.$t("download")]]),F((o(),b(q,{class:"sm",onClick:c[5]||(c[5]=I(S=>C(n.item),["stop"]))},{default:m(()=>[u(Z)]),_:1})),[[z,n.$t("delete")]]),u(K,{modelValue:y.value,"onUpdate:modelValue":c[6]||(c[6]=S=>y.value=S)},{trigger:m(()=>[F((o(),b(q,{class:"sm"},{default:m(()=>[u(J)]),_:1})),[[z,n.$t("info")]])]),default:m(()=>[v("section",_n,[v("div",gn,[v("div",hn,_(n.$t("path")),1),v("div",yn,_(n.item.path),1)])])]),_:1},8,["modelValue"]),u(K,{modelValue:w.value,"onUpdate:modelValue":c[14]||(c[14]=S=>w.value=S)},{trigger:m(()=>[F((o(),b(q,{class:"sm"},{default:m(()=>[u(M)]),_:1})),[[z,n.$t("actions")]])]),default:m(()=>[v("div",{class:"dropdown-item",onClick:c[7]||(c[7]=I(S=>{h(n.item),w.value=!1},["stop"]))},_(n.$t("duplicate")),1),v("div",{class:"dropdown-item",onClick:c[8]||(c[8]=I(S=>{V(n.item),w.value=!1},["stop"]))},_(n.$t("cut")),1),v("div",{class:"dropdown-item",onClick:c[9]||(c[9]=I(S=>{H(n.item),w.value=!1},["stop"]))},_(n.$t("copy")),1),n.item.isDir&&n.canPaste?(o(),r("div",{key:0,class:"dropdown-item",onClick:c[10]||(c[10]=I(S=>{E(n.item),w.value=!1},["stop"]))},_(n.$t("paste")),1)):P("",!0),n.item.isDir?P("",!0):(o(),r("div",{key:1,class:"dropdown-item",onClick:c[11]||(c[11]=I(S=>{e(n.item),w.value=!1},["stop"]))},_(n.$t("copy_link")),1)),n.item.isDir?(o(),r("div",{key:2,class:"dropdown-item",onClick:c[12]||(c[12]=I(S=>{k(n.item),w.value=!1},["stop"]))},_(n.$t("add_to_favorites")),1)):P("",!0),v("div",{class:"dropdown-item",onClick:c[13]||(c[13]=I(S=>{l(n.item),w.value=!1},["stop"]))},_(n.$t("rename")),1)]),_:1},8,["modelValue"])])}}}),bn=ae(kn,[["__scopeId","data-v-c4ee8d44"]]),In={class:"start"},wn={class:"number"},$n={key:0,src:"/ficons/folder.svg",class:"svg"},Dn={key:0,class:"svg",src:ce},Cn=["src"],Tn=["src"],Fn={key:3,class:"svg",src:ce},qn={class:"title"},Sn={class:"subtitle"},Vn={key:0},Pn={key:1},En={key:0,src:"/ficons/folder.svg",class:"svg"},Bn={key:0,class:"svg",src:ce},Ln=["src"],Un=["src"],An={key:3,class:"svg",src:ce},Mn={key:0},On={key:1},Rn=Q({__name:"FileListItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},imageErrorIds:{},extensionImageErrorIds:{},canPaste:{type:Boolean},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function},onImageError:{type:Function},onExtensionImageError:{type:Function},viewItem:{type:Function},clickItem:{type:Function}},emits:["downloadDir","downloadFile","uploadFiles","uploadDir","deleteItem","duplicateItem","cutItem","copyItem","pasteItem","copyLink","renameItem","addToFavorites"],setup(g,{emit:f}){const s=f;function $(e){s("downloadDir",e)}function y(e){s("downloadFile",e)}function w(e){s("uploadFiles",e)}function d(e){s("uploadDir",e)}function D(e){s("deleteItem",e)}function U(e){s("duplicateItem",e)}function A(e){s("cutItem",e)}function C(e){s("copyItem",e)}function h(e){s("pasteItem",e)}function V(e){s("copyLink",e)}function H(e){s("renameItem",e)}function E(e){s("addToFavorites",e)}return(e,l)=>{const k=Ct,n=rn,c=bn,R=wo,q=le("tooltip");return e.isPhone?(o(),b(R,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:l[10]||(l[10]=p=>e.handleItemClick(p,e.item,e.index,()=>e.clickItem(e.item))),onMouseover:l[11]||(l[11]=p=>e.handleMouseOver(p,e.index)),onCheckboxClick:l[12]||(l[12]=p=>e.toggleSelect(p,e.item,e.index))},{image:m(()=>[v("div",{class:"image",onClick:l[9]||(l[9]=p=>e.viewItem(p,e.item))},[e.item.isDir?(o(),r("img",En)):(o(),r(O,{key:1},[e.extensionImageErrorIds.includes(e.item.id)?(o(),r("img",Bn)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),r("img",{key:1,class:"image-thumb",src:i(st)(e.item.fileId,"&w=50&h=50"),onError:l[7]||(l[7]=p=>e.onImageError(e.item.id))},null,40,Ln)):e.item.extension?(o(),r("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:l[8]||(l[8]=p=>e.onExtensionImageError(e.item.id))},null,40,Un)):(o(),r("img",An))],64))])]),title:m(()=>[Y(_(e.item.name),1)]),subtitle:m(()=>[e.item.isDir?(o(),r("span",Mn,_(e.$t("x_items",e.item.children||0)),1)):(o(),r("span",On,_(i(G)(e.item.size)),1)),F((o(),r("span",null,[Y(_(i(lt)(e.item.updatedAt)),1)])),[[q,i(it)(e.item.updatedAt)]])]),actions:m(()=>[u(c,{item:e.item,"can-paste":e.canPaste,onDownloadDir:$,onDownloadFile:y,onUploadFiles:w,onUploadDir:d,onDeleteItem:D,onDuplicateItem:U,onCutItem:A,onCopyItem:C,onPasteItem:h,onCopyLink:V,onRenameItem:H,onAddToFavorites:E},null,8,["item","can-paste"])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(o(),r("section",{key:0,class:kt(["file-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:l[5]||(l[5]=I(p=>e.handleItemClick(p,e.item,e.index,()=>e.clickItem(e.item)),["stop"])),onMouseover:l[6]||(l[6]=p=>e.handleMouseOver(p,e.index))},[v("div",In,[e.shiftEffectingIds.includes(e.item.id)?(o(),b(k,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:l[0]||(l[0]=I(p=>e.toggleSelect(p,e.item,e.index),["stop"]))},null,8,["checked"])):(o(),b(k,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:l[1]||(l[1]=I(p=>e.toggleSelect(p,e.item,e.index),["stop"]))},null,8,["checked"])),v("span",wn,[u(n,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),v("div",{class:"image",onClick:l[4]||(l[4]=p=>e.viewItem(p,e.item))},[e.item.isDir?(o(),r("img",$n)):(o(),r(O,{key:1},[e.extensionImageErrorIds.includes(e.item.id)?(o(),r("img",Dn)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),r("img",{key:1,class:"image-thumb",src:i(st)(e.item.fileId,"&w=50&h=50"),onError:l[2]||(l[2]=p=>e.onImageError(e.item.id))},null,40,Cn)):e.item.extension?(o(),r("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:l[3]||(l[3]=p=>e.onExtensionImageError(e.item.id))},null,40,Tn)):(o(),r("img",Fn))],64))]),v("div",qn,_(e.item.name),1),v("div",Sn,[e.item.isDir?(o(),r("span",Vn,_(e.$t("x_items",e.item.children||0)),1)):(o(),r("span",Pn,_(i(G)(e.item.size)),1)),F((o(),r("span",null,[Y(_(i(lt)(e.item.updatedAt)),1)])),[[q,i(it)(e.item.updatedAt)]])]),u(c,{item:e.item,"can-paste":e.canPaste,onDownloadDir:$,onDownloadFile:y,onUploadFiles:w,onUploadDir:d,onDeleteItem:D,onDuplicateItem:U,onCutItem:A,onCopyItem:C,onPasteItem:h,onCopyLink:V,onRenameItem:H,onAddToFavorites:E},null,8,["item","can-paste"])],34))}}}),zn=ae(Rn,[["__scopeId","data-v-bb5cd699"]]),Hn={key:0,class:"file-item selectable-card-skeleton"},Kn={class:"start"},jn={class:"number"},Nn=Q({__name:"FileSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(g){return(f,s)=>{const $=dn;return f.isPhone?(o(),b($,{key:1,"title-width":"60%",subtitles:[{width:"45%"},{width:"40%"}],"action-count":5})):(o(),r("section",Hn,[v("div",Kn,[s[0]||(s[0]=v("div",{class:"skeleton-checkbox"},null,-1)),v("span",jn,_(f.index),1)]),s[1]||(s[1]=Co('<div class="image" data-v-037471a7><div class="skeleton-image lg" data-v-037471a7></div></div><div class="title" data-v-037471a7><div class="skeleton-text lg" style="width:40%;" data-v-037471a7></div></div><div class="subtitle" data-v-037471a7><div class="skeleton-text" style="width:30%;" data-v-037471a7></div></div><div class="actions" data-v-037471a7><div class="skeleton-text lg" style="width:240px;" data-v-037471a7></div></div>',4))]))}}}),Gn=ae(Nn,[["__scopeId","data-v-037471a7"]]),Qn={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Jn(g,f){return o(),r("svg",Qn,f[0]||(f[0]=[v("path",{fill:"currentColor",d:"M19.075 21.9L17.5 20.35q-1.225.8-2.613 1.225T12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12q0-1.5.425-2.887T3.65 6.5L2.075 4.925q-.3-.3-.3-.712t.3-.713t.713-.3t.712.3l17 17q.3.3.3.7t-.3.7t-.712.3t-.713-.3M12 20q1.075 0 2.088-.275t1.962-.825L5.1 7.95q-.55.95-.825 1.962T4 12q0 3.325 2.338 5.663T12 20m0-16q-.825 0-1.612.163T8.85 4.65q-.4.175-.8.05t-.6-.475t-.088-.75t.488-.575q.975-.45 2.012-.675T12 2q2.075 0 3.9.788t3.175 2.137T21.213 8.1T22 12q0 1.1-.225 2.138T21.1 16.15q-.175.375-.575.488t-.75-.088t-.475-.6t.05-.8q.325-.75.488-1.537T20 12q0-3.325-2.337-5.663T12 4m-1.425 9.425"},null,-1)]))}const Wn=me({name:"material-symbols-hide-source-outline-rounded",render:Jn}),Tt=Q({__name:"FileSearchFilters",props:{filter:{type:Object,required:!0}},emits:["filterChange"],setup(g,{emit:f}){const s=g,$=f;function y(){const d={...s.filter};d.text="",$("filterChange",d)}function w(){const d={...s.filter};d.showHidden=!1,$("filterChange",d)}return(d,D)=>{const U=mn,A=Wn,C=bt;return g.filter.text||g.filter.showHidden?(o(),b(C,{key:0},{default:m(()=>[g.filter.text?(o(),b(U,{key:"filter-text",label:g.filter.text,"remove-only":"",onRemove:y},null,8,["label"])):P("",!0),g.filter.showHidden?(o(),b(U,{key:"filter-show-hidden",label:d.$t("show_hidden"),"remove-only":"",onRemove:w},{default:m(()=>[u(A)]),_:1},8,["label"])):P("",!0)]),_:1})):P("",!0)}}}),Xn={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Yn(g,f){return o(),r("svg",Xn,f[0]||(f[0]=[v("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h5.175q.4 0 .763.15t.637.425L12 6h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6zm10-4v1q0 .425.288.713T15 16t.713-.288T16 15v-1h1q.425 0 .713-.288T18 13t-.288-.712T17 12h-1v-1q0-.425-.288-.712T15 10t-.712.288T14 11v1h-1q-.425 0-.712.288T12 13t.288.713T13 14z"},null,-1)]))}const Zn=me({name:"material-symbols-create-new-folder-outline-rounded",render:Yn}),xn=Q({__name:"FilesKeyboardShortcuts",setup(g){const f=[{keys:["Delete"],description:"delete_selected"},{keys:["modifier","+","Backspace"],description:"delete_selected"},{keys:["modifier","+","A"],description:"select_all"},{keys:["Esc"],description:"clear_selection"},{keys:["Shift","+","Click"],description:"range_select"}];return(s,$)=>{const y=To;return o(),b(y,{shortcuts:f})}}}),es=["onClick"],ts=Q({__name:"FilesActionButtons",props:{currentDir:{type:String,required:!0},canPaste:{type:Boolean,required:!0},pasting:{type:Boolean,required:!0},refreshing:{type:Boolean,required:!0},sorting:{type:Boolean,required:!0},sortItems:{type:Array,required:!0},fileSortBy:{type:String,required:!0}},emits:["createDir","uploadFiles","uploadDir","pasteDir","refreshCurrentDir","sort"],setup(g,{emit:f}){const s=f,$=L(!1),y=L(!1);function w(){s("createDir")}function d(h){s("uploadFiles",h)}function D(h){s("uploadDir",h)}function U(){s("pasteDir")}function A(){s("refreshCurrentDir")}function C(h){s("sort",h)}return(h,V)=>{const H=xn,E=Zn,e=Se,l=Dt,k=Ve,n=fn,c=Fo,R=an,q=le("tooltip");return o(),r(O,null,[u(H),F((o(),b(e,{onClick:w},{default:m(()=>[u(E)]),_:1})),[[q,h.$t("create_folder")]]),u(k,{modelValue:$.value,"onUpdate:modelValue":V[2]||(V[2]=p=>$.value=p)},{trigger:m(()=>[F((o(),b(e,null,{default:m(()=>[u(l)]),_:1})),[[q,h.$t("upload")]])]),default:m(()=>[v("div",{class:"dropdown-item",onClick:V[0]||(V[0]=I(p=>{d(g.currentDir),$.value=!1},["stop"]))},_(h.$t("upload_files")),1),v("div",{class:"dropdown-item",onClick:V[1]||(V[1]=I(p=>{D(g.currentDir),$.value=!1},["stop"]))},_(h.$t("upload_folder")),1)]),_:1},8,["modelValue"]),g.canPaste?F((o(),b(e,{key:0,loading:g.pasting,onClick:U},{default:m(()=>[u(n)]),_:1},8,["loading"])),[[q,h.$t("paste")]]):P("",!0),F((o(),b(e,{loading:g.refreshing,onClick:A},{default:m(()=>[u(c)]),_:1},8,["loading"])),[[q,h.$t("refresh")]]),u(k,{modelValue:y.value,"onUpdate:modelValue":V[3]||(V[3]=p=>y.value=p)},{trigger:m(()=>[F((o(),b(e,{loading:g.sorting},{default:m(()=>[u(R)]),_:1},8,["loading"])),[[q,h.$t("sort")]])]),default:m(()=>[(o(!0),r(O,null,qe(g.sortItems,p=>(o(),r("div",{key:p.value,class:kt(["dropdown-item",{selected:p.value===g.fileSortBy}]),onClick:K=>{C(p.value),y.value=!1}},_(h.$t(p.label)),11,es))),128))]),_:1},8,["modelValue"])],64)}}}),os={class:"btn-icon"},ns={class:"filters"},ss={class:"form-row"},is={class:"buttons"},ls={class:"form-label"},as=Q({__name:"FileSearchInput",props:{parent:{type:String,required:!0},filter:{type:Object,required:!0},getUrl:{type:Function,required:!0},navigateToDir:{type:Function,required:!1,default:()=>{}},showChips:{type:Boolean,default:!0},isPhone:{type:Boolean,default:!1}},setup(g,{expose:f}){const{buildQ:s}=$t(),$=It(),y=g,w=L(!1),d=L(!1),D=wt({showHidden:!1,type:"",rootPath:"",text:"",parent:""});Ce(y.filter,l=>{Object.assign(D,l)},{immediate:!0,deep:!0}),Ce(w,l=>{l&&Object.assign(D,y.filter)}),Ce(d,l=>{l&&Object.assign(D,y.filter)});function U(l){return l.startsWith("/")}function A(){var k;const l=(k=D.text)==null?void 0:k.trim();if(l&&U(l)&&y.navigateToDir){y.navigateToDir(l),w.value=!1;return}V(),w.value=!1}function C(){d.value=!0}function h(){var k;const l=(k=D.text)==null?void 0:k.trim();if(l&&U(l)&&y.navigateToDir){y.navigateToDir(l),d.value=!1;return}V(),d.value=!1}function V(){Object.assign(y.filter,D),H(y.filter)}function H(l){ue($,y.getUrl(s(l)))}function E(){D.showHidden=!D.showHidden}function e(l){Object.assign(y.filter,l),ue($,y.getUrl(s(y.filter)))}return f({dismiss:()=>{w.value=!1,d.value=!1}}),(l,k)=>{const n=pn,c=So,R=Vo,q=bt,p=Po,K=Ve,Z=qo,J=le("tooltip");return o(),r(O,null,[g.showChips?(o(),b(Tt,{key:0,filter:g.filter,onFilterChange:e},null,8,["filter"])):P("",!0),g.isPhone?P("",!0):(o(),b(K,{key:1,modelValue:w.value,"onUpdate:modelValue":k[1]||(k[1]=M=>w.value=M),"max-height":400},{trigger:m(()=>[F((o(),r("button",os,[u(n)])),[[J,l.$t("search")]])]),default:m(()=>[v("div",ns,[v("div",ss,[u(c,{modelValue:D.text,"onUpdate:modelValue":k[0]||(k[0]=M=>D.text=M),label:l.$t("keywords"),onKeyup:at(A,["enter"])},null,8,["modelValue","label"])]),u(q,null,{default:m(()=>[u(R,{key:"chip-show-hidden",label:l.$t("show_hidden"),selected:D.showHidden,onClick:E},null,8,["label","selected"])]),_:1}),v("div",is,[u(p,{onClick:I(A,["stop"])},{default:m(()=>[Y(_(l.$t("search")),1)]),_:1})])])]),_:1},8,["modelValue"])),g.isPhone?F((o(),r("button",{key:2,class:"btn-icon mobile-search-btn",onClick:C},[u(n)])),[[J,l.$t("search")]]):P("",!0),g.isPhone?(o(),b(Z,{key:3,modelValue:d.value,"onUpdate:modelValue":k[3]||(k[3]=M=>d.value=M),title:l.$t("search"),"show-footer":""},{footer:m(()=>[u(p,{class:"search-apply-btn",onClick:h},{default:m(()=>[Y(_(l.$t("search")),1)]),_:1})]),default:m(()=>[v("label",ls,_(l.$t("keywords")),1),u(c,{modelValue:D.text,"onUpdate:modelValue":k[2]||(k[2]=M=>D.text=M),onKeyup:at(h,["enter"])},null,8,["modelValue"]),u(q,{style:{"margin-block-start":"16px"}},{default:m(()=>[u(R,{label:l.$t("show_hidden"),selected:D.showHidden,onClick:E},null,8,["label","selected"])]),_:1})]),_:1},8,["modelValue","title"])):P("",!0)],64)}}}),rs=ae(as,[["__scopeId","data-v-74f5c5d2"]]),ds={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function us(g,f){return o(),r("svg",ds,f[0]||(f[0]=[v("path",{fill:"currentColor",d:"m12 14l-2.35 2.35q.2.375.275.8T10 18q0 1.65-1.175 2.825T6 22t-2.825-1.175T2 18t1.175-2.825T6 14q.425 0 .85.075t.8.275L10 12L7.65 9.65q-.375.2-.8.275T6 10q-1.65 0-2.825-1.175T2 6t1.175-2.825T6 2t2.825 1.175T10 6q0 .425-.075.85t-.275.8L20.6 18.6q.675.675.3 1.538T19.575 21q-.275 0-.537-.112t-.463-.313zm3-3l-2-2l5.575-5.575q.2-.2.463-.312T19.574 3q.95 0 1.313.875t-.313 1.55zM6 8q.825 0 1.413-.587T8 6t-.587-1.412T6 4t-1.412.588T4 6t.588 1.413T6 8m6 4.5q.2 0 .35-.15t.15-.35t-.15-.35t-.35-.15t-.35.15t-.15.35t.15.35t.35.15M6 20q.825 0 1.413-.587T8 18t-.587-1.412T6 16t-1.412.588T4 18t.588 1.413T6 20"},null,-1)]))}const cs=me({name:"material-symbols-content-cut-rounded",render:us}),ms={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ps(g,f){return o(),r("svg",ms,f[0]||(f[0]=[v("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm0-2h9V4H9zm-4 6q-.825 0-1.412-.587T3 20V7q0-.425.288-.712T4 6t.713.288T5 7v13h10q.425 0 .713.288T16 21t-.288.713T15 22zm4-6V4z"},null,-1)]))}const fs=me({name:"material-symbols-content-copy-outline-rounded",render:ps}),vs=Eo("files",{state:()=>({selectedFiles:[],isCut:!1})}),_s={class:"top-app-bar"},gs={class:"title"},hs={key:0},ys={key:1,class:"breadcrumb"},ks={key:0},bs=["onClick"],Is={key:0},ws=["onClick"],$s={key:0,class:"actions"},Ds={key:0,class:"secondary-actions"},Cs={key:2,class:"scroller-wrapper"},Ts={class:"scroller main-list"},Fs={key:1,class:"no-data-placeholder"},gt=1e4,qs=Q({__name:"FilesView",setup(g){var tt;const f=Qo("isPhone"),{t:s}=Bo(),$=L([]),{parseQ:y,buildQ:w}=$t(),d=wt({type:"",rootPath:"",showHidden:!1,text:"",parent:""}),U=Lo().query,A=L(""),C=L([]),{selectedIds:h,allChecked:V,realAllChecked:H,clearSelection:E,toggleAllChecked:e,toggleSelect:l,total:k,checked:n,shiftEffectingIds:c,handleItemClick:R,handleMouseOver:q,selectAll:p,shouldSelect:K}=un(C),{keyDown:Z,keyUp:J}=cn(p,E,()=>{Ne()}),M=L(!1),z=L(!1),S=L([]),Pe=L([]),Ft=t=>{S.value.push(t)},qt=t=>{Pe.value.push(t)},Ee=Jo(),pe=It(),{fileSortBy:se}=Te(pe),Be=Uo(),{app:fe,urlTokenKey:j,uploads:ve}=Te(Be),{selectedFiles:St,isCut:Vt}=Te(vs()),{dropping:Pt,fileDragEnter:Le,fileDragLeave:Ue,dropFiles:Et}=Ao(ve),x=rt(()=>d.rootPath),{createPath:Bt,createVariables:Lt,createMutation:Ut}=Mo(j,C),{renameItem:At,renameDone:Mt,renameMutation:Ot,renameVariables:Rt}=Oo(()=>{ee()}),{internal:Ae,sdcard:Me,usb:zt,refetch:_e}=Ro(),{downloadFile:ge,downloadDir:Ht,downloadFiles:Kt}=jo(j),{view:Oe}=nn($,(t,a)=>{Be.lightbox={sources:t,index:a,visible:!0}}),jt=L(parseInt(((tt=U.page)==null?void 0:tt.toString())??"1")),Nt=rt(()=>{const t=[];let a=d.parent;for(;a&&a!==x.value;)t.unshift({path:a,name:zo(a)}),a=a.substring(0,a.lastIndexOf("/"));return t.unshift({path:x.value,name:eo()}),t}),Re=L(!0),{loading:he,fetch:ee}=Ho({handle:async(t,a)=>{if(Re.value=!1,M.value=!1,z.value=!1,a)W(s(a),"error");else{const B=[];for(const te of t.files)B.push(xo(te,j.value));C.value=B,k.value=B.length}},document:Zo,variables:()=>({root:x.value,offset:(jt.value-1)*gt,limit:gt,query:A.value,sortBy:se.value}),options:{fetchPolicy:"cache-and-network"}}),{loading:ze,canPaste:ye,copy:ke,cut:He,paste:be}=Ko(C,Vt,St,ee,_e),{input:Gt,upload:Qt,uploadChanged:Ke}=dt(ve),{input:Jt,upload:Wt,uploadChanged:je}=dt(ve),{loading:Xt,mutate:Yt,onDone:Zt}=ut({document:en});Zt(t=>{Kt(t.data.setTempValue.key),E()});const xt=()=>{Yt({key:on(),value:JSON.stringify(h.value.map(t=>({path:t})))})},Ie=t=>{t.forEach(a=>{ln(C.value,B=>B.id===a.id)}),k.value=C.value.length,E(),_e()},Ne=()=>{de(mt,{files:C.value.filter(t=>h.value.includes(t.id)),onDone:t=>{Ie(t)}})};function eo(){if(d.type==="SDCARD")return s("sdcard");if(d.type==="APP")return s("app_data");if(d.type==="USB_STORAGE"){const t=fe.value.usbDiskPaths.indexOf(d.rootPath),a=t!==-1?t+1:1;return`${s("usb_storage")} ${a}`}return s("internal_storage")}function Ge(){var t,a,B,te;if(d.type==="SDCARD")return`${s("storage_free_total",{free:G(((t=Me.value)==null?void 0:t.freeBytes)??0),total:G(((a=Me.value)==null?void 0:a.totalBytes)??0)})}`;if(d.type==="APP")return s("app_data");if(d.type==="USB_STORAGE"){const oe=fe.value.usbDiskPaths.indexOf(d.rootPath),N=zt.value[oe];return`${s("storage_free_total",{free:G((N==null?void 0:N.freeBytes)??0),total:G((N==null?void 0:N.totalBytes)??0)})}`}return`${G(((B=Ae.value)==null?void 0:B.freeBytes)??0)} / ${G(((te=Ae.value)==null?void 0:te.totalBytes)??0,!0,0)}`}function ie(t){E(),d.parent=t,d.text="";const a=w(d);ue(pe,re(a))}function re(t){return t?`/files?q=${t}`:"/files"}function to(t){if(t.isDir){ie(t.path);return}if(pt(t.name)){const a=ft(j.value,t.path);window.open(`/text-file?id=${encodeURIComponent(a)}`,"_blank")}else vt(t.name)?window.open(Fe(j.value,t.path),"_blank"):_t(t.name)?Oe(C.value,t):ge(t.path)}function oo(t,a){if(!a.isDir)if(t.stopPropagation(),pt(a.name)){const B=ft(j.value,a.path);window.open(`/text-file?id=${encodeURIComponent(B)}`,"_blank")}else vt(a.name)?window.open(Fe(j.value,a.path),"_blank"):_t(a.name)?Oe(C.value,a):ge(a.path)}function Qe(t){se.value!==t&&(z.value=!0,se.value=t)}function Je(){M.value=!0,ee()}const We=()=>{Bt.value=d.parent,de(ct,{title:s("create_folder"),placeholder:s("name"),mutation:Ut,getVariables:Lt})};function we(t){Qt(t)}function $e(t){Wt(t)}function no(){ke(h.value),E()}function so(){He(h.value),E()}function Xe(){be(d.parent)}function io(t){ke([t.id]),be(d.parent)}function lo(t){He([t.id])}function ao(t){ke([t.id])}function ro(t){const a=Fe(j.value,t.path);navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(a).then(()=>{W(s("link_copied"))}).catch(()=>{Ye(a)}):Ye(a)}function Ye(t){try{const a=document.createElement("textarea");a.value=t,a.style.position="fixed",a.style.left="-999999px",a.style.top="-999999px",document.body.appendChild(a),a.focus(),a.select();const B=document.execCommand("copy");document.body.removeChild(a),B?W(s("link_copied")):W(s("copy_failed"),"error")}catch(a){console.error("Failed to copy text: ",a),W(s("copy_failed"),"error")}}function uo(t){be(t.path)}function co(t){At.value=t,de(ct,{title:s("rename"),placeholder:s("name"),value:t.name,mutation:Ot,getVariables:Rt,done:Mt})}function mo(t){de(mt,{files:[t],onDone:Ie})}const{mutate:po,loading:Ss}=ut({document:tn,options:{update:()=>{X.emit("refetch_app")}}});function fo(t){if(!t.isDir)return;let a=x.value;po({rootPath:a,fullPath:t.path}).then(()=>{W(s("added"))}).catch(B=>{console.error("Error adding favorite folder:",B),W(s("error"),"error")})}function vo(t){Object.assign(d,t);const a=w(d);ue(pe,re(a))}const Ze=t=>{t.status==="done"&&setTimeout(()=>{ee(),_e()},1e3)},xe=t=>{Ie([t.item])},et=t=>{ee()};function _o(t){Et(t,d.parent,()=>!0)}return No(()=>{var t;A.value=sn(((t=U.q)==null?void 0:t.toString())??""),y(d,A.value),ee(),X.on("upload_task_done",Ze),X.on("file_deleted",xe),X.on("file_renamed",et),window.addEventListener("keydown",Z),window.addEventListener("keyup",J)}),Go(()=>{X.off("upload_task_done",Ze),X.off("file_deleted",xe),X.off("file_renamed",et),window.removeEventListener("keydown",Z),window.removeEventListener("keyup",J)}),(t,a)=>{const B=Ct,te=fs,oe=Se,N=cs,go=yt,ho=ht,ot=rs,nt=ts,yo=Tt,ko=Gn,bo=zn,ne=le("tooltip");return o(),r(O,null,[v("div",_s,[u(B,{"touch-target":"wrapper",checked:i(V),indeterminate:!i(V)&&i(n),onChange:i(e)},null,8,["checked","indeterminate","onChange"]),v("div",gs,[i(h).length?(o(),r("span",hs,_(t.$t("x_selected",{count:i(H)?i(k).toLocaleString():i(h).length.toLocaleString()})),1)):(o(),r("div",ys,[(o(!0),r(O,null,qe(Nt.value,(T,De)=>(o(),r(O,{key:T.path},[De===0?(o(),r(O,{key:0},[T.path===d.parent?F((o(),r("span",ks,[Y(_(T.name)+" ("+_(i(k))+")",1)])),[[ne,Ge()]]):F((o(),r("a",{key:1,href:"#",onClick:I(Io=>ie(T.path),["stop","prevent"])},[Y(_(T.name),1)],8,bs)),[[ne,Ge()]])],64)):(o(),r(O,{key:1},[T.path===d.parent?(o(),r("span",Is,_(T.name)+" ("+_(i(k))+")",1)):(o(),r("a",{key:1,href:"#",onClick:I(Io=>ie(T.path),["stop","prevent"])},_(T.name),9,ws))],64))],64))),128))])),i(n)?(o(),r(O,{key:2},[F((o(),b(oe,{onClick:I(no,["stop"])},{default:m(()=>[u(te)]),_:1})),[[ne,t.$t("copy")]]),F((o(),b(oe,{onClick:I(so,["stop"])},{default:m(()=>[u(N)]),_:1})),[[ne,t.$t("cut")]]),F((o(),b(oe,{onClick:I(Ne,["stop"])},{default:m(()=>[u(go)]),_:1})),[[ne,t.$t("delete")]]),F((o(),b(oe,{loading:i(Xt),onClick:I(xt,["stop"])},{default:m(()=>[u(ho)]),_:1},8,["loading"])),[[ne,t.$t("download")]])],64)):P("",!0)]),!i(f)&&!i(n)?(o(),r("div",$s,[u(ot,{filter:d,parent:x.value,"get-url":re,"navigate-to-dir":ie,"show-chips":!i(f),"is-phone":i(f)},null,8,["filter","parent","show-chips","is-phone"]),u(nt,{"current-dir":d.parent,"can-paste":i(ye)(),pasting:i(ze),refreshing:M.value,sorting:z.value,"sort-items":i(Ee),"file-sort-by":i(se),onCreateDir:We,onUploadFiles:we,onUploadDir:$e,onPasteDir:Xe,onRefreshCurrentDir:Je,onSort:Qe},null,8,["current-dir","can-paste","pasting","refreshing","sorting","sort-items","file-sort-by"])])):P("",!0)]),i(f)&&!i(n)?(o(),r("div",Ds,[u(ot,{filter:d,parent:x.value,"get-url":re,"navigate-to-dir":ie,"show-chips":!i(f),"is-phone":i(f)},null,8,["filter","parent","show-chips","is-phone"]),u(nt,{"current-dir":d.parent,"can-paste":i(ye)(),pasting:i(ze),refreshing:M.value,sorting:z.value,"sort-items":i(Ee),"file-sort-by":i(se),onCreateDir:We,onUploadFiles:we,onUploadDir:$e,onPasteDir:Xe,onRefreshCurrentDir:Je,onSort:Qe},null,8,["current-dir","can-paste","pasting","refreshing","sorting","sort-items","file-sort-by"])])):P("",!0),i(f)?(o(),b(yo,{key:1,class:"mobile-search-filters",filter:d,onFilterChange:vo},null,8,["filter"])):P("",!0),i(he)&&Re.value?(o(),r("div",Cs,[v("div",Ts,[(o(),r(O,null,qe(20,T=>u(ko,{key:T,index:T,"is-phone":i(f)},null,8,["index","is-phone"])),64))])])):P("",!0),v("div",{class:"scroller-wrapper",onDragover:a[3]||(a[3]=I((...T)=>i(Le)&&i(Le)(...T),["stop","prevent"]))},[F(v("div",{class:"drag-mask",onDrop:I(_o,["stop","prevent"]),onDragleave:a[0]||(a[0]=I((...T)=>i(Ue)&&i(Ue)(...T),["stop","prevent"]))},_(t.$t("release_to_send_files")),545),[[Wo,i(Pt)]]),C.value.length>0?(o(),b(i(Xo),{key:0,class:"scroller main-list","data-key":"id","data-sources":C.value,"estimate-size":80},{item:m(({index:T,item:De})=>[u(bo,{item:De,index:T,"selected-ids":i(h),"shift-effecting-ids":i(c),"should-select":i(K),"is-phone":i(f),"image-error-ids":S.value,"extension-image-error-ids":Pe.value,"can-paste":i(ye)(),"handle-item-click":i(R),"handle-mouse-over":i(q),"toggle-select":i(l),"on-image-error":Ft,"on-extension-image-error":qt,"view-item":oo,"click-item":to,onDownloadDir:i(Ht),onDownloadFile:i(ge),onUploadFiles:we,onUploadDir:$e,onDeleteItem:mo,onDuplicateItem:io,onCutItem:lo,onCopyItem:ao,onPasteItem:uo,onCopyLink:ro,onRenameItem:co,onAddToFavorites:fo},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","image-error-ids","extension-image-error-ids","can-paste","handle-item-click","handle-mouse-over","toggle-select","onDownloadDir","onDownloadFile"])]),_:1},8,["data-sources"])):P("",!0),!i(he)&&C.value.length===0?(o(),r("div",Fs,_(t.$t(i(Yo)(i(he),i(fe).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):P("",!0),v("input",{ref_key:"fileInput",ref:Gt,style:{display:"none"},type:"file",multiple:"",onChange:a[1]||(a[1]=(...T)=>i(Ke)&&i(Ke)(...T))},null,544),v("input",{ref_key:"dirFileInput",ref:Jt,style:{display:"none"},type:"file",multiple:"",webkitdirectory:"",mozdirectory:"",directory:"",onChange:a[2]||(a[2]=(...T)=>i(je)&&i(je)(...T))},null,544)],32)],64)}}}),Rs=ae(qs,[["__scopeId","data-v-10c8140f"]]);export{Rs as default};
