import{_ as dt}from"./VPagination.vuevuetypescriptsetuptruelang-DR_a4LYu.js";import{_ as ut,b as rt,u as ct,a as mt}from"./key-events-BbWVt8Hy.js";import{d as X,c as o,M as q,o as l,a as r,N as pt,t as i,r as F,aD as vt,ai as Ee,aj as _t,h as U,R as ne,aE as ft,aF as yt,a0 as V,a1 as N,J as z,aG as De,L as be,m as ce,aH as Fe,aI as ze,aJ as Be,aK as Z,x as h,j as c,an as ge,k as s,C as Re,A as Oe,y as bt,z as gt,aL as Pe,W as Ke,u as Qe,i as fe,aM as Ne,af as ye,ac as he,al as ht,aN as $t,O as P,P as $e,I as ke,B,Q as je,aO as qe,T as kt,U as Le,V as Se,aP as re,e as Ct,s as wt,f as Vt,X as Tt,Y as It,g as Nt,w as qt,Z as Lt,$ as St,a2 as Ut,a5 as ue,aQ as Mt,H as Ue,aR as At,K as Et,ao as Dt,v as Ft,a4 as zt,D as Bt,a6 as Rt,ag as Ot,a7 as x,a8 as Pt,a9 as Kt,aS as Qt}from"./index-DZ3IxO2v.js";import{_ as jt}from"./AllCheckedAlert.vuevuetypescriptsetuptruelang-CzZUXFqs.js";import{_ as He}from"./VCheckbox-BHBPE4Up.js";import{u as Ht,a as Gt}from"./tags-D55S98RS.js";import{_ as Wt}from"./ListItemPhone.vuevuetypescriptsetuptruelang-DrTHKM3L.js";import{_ as Jt}from"./call-outline-rounded-Bo-O1ViI.js";import{_ as Zt}from"./FieldId.vuevuetypescriptsetuptruelang-C6gjdM58.js";const Xt={key:0,class:"contact-item selectable-card-skeleton"},Yt={class:"start"},xt={class:"number"},el=X({__name:"ContactSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(L){return(b,f)=>{const a=ut;return b.isPhone?(l(),q(a,{key:1,"title-width":"70%",subtitles:[{width:"45%"},{width:"30%"},{width:"40%"}],"action-count":3})):(l(),o("section",Xt,[r("div",Yt,[f[0]||(f[0]=r("div",{class:"skeleton-checkbox"},null,-1)),r("span",xt,i(b.index),1)]),f[1]||(f[1]=pt('<div class="image"><div class="skeleton-image lg"></div></div><div class="title"><div class="skeleton-text lg" style="width:50%;"></div></div><div class="subtitle"><div class="skeleton-text" style="width:40%;"></div></div><div class="info"><div class="skeleton-text" style="width:180px;"></div></div><div class="actions"><div class="skeleton-text lg" style="width:120px;"></div></div><div class="time"><div class="skeleton-text" style="width:60px;"></div></div>',6))]))}}}),tl={class:"v-select__border"},ll={key:0,class:"v-select__legend"},ol={class:"v-select__content"},nl={key:0,class:"v-select__text"},sl={key:1,class:"v-select__placeholder"},al=["onClick"],il={key:0,class:"v-select-option__check",viewBox:"0 0 24 24"},dl=X({__name:"VSelect",props:{modelValue:{},label:{},placeholder:{},disabled:{type:Boolean},error:{type:Boolean},options:{}},emits:["update:modelValue","change"],setup(L,{emit:b}){const f=L,a=b,g=F(),M=F(),$=F(!1),A=F(!1),e=F({}),v=vt(()=>{var p;return!f.modelValue||!f.options?"":((p=f.options.find(C=>C.value===f.modelValue))==null?void 0:p.label)||""}),k=()=>{$.value=!1,A.value=!1},E=async()=>{if(!f.disabled&&($.value=!0,A.value=!0,await De(),g.value)){const p=g.value.getBoundingClientRect();e.value={position:"fixed",top:`${p.bottom+4}px`,left:`${p.left}px`,minWidth:`${p.width}px`,maxHeight:"50vh",zIndex:9999}}},T=()=>{f.disabled||($.value?k():E())},D=p=>{p.disabled||(a("update:modelValue",p.value),a("change",p.value),k())},R=p=>{if(!f.disabled)switch(p.key){case"Enter":case" ":p.preventDefault(),T();break;case"Escape":$.value&&(p.preventDefault(),k());break;case"ArrowDown":case"ArrowUp":p.preventDefault(),$.value||E();break}},Q=p=>{$.value&&g.value&&!g.value.contains(p.target)&&(!M.value||!M.value.contains(p.target))&&k()};return Ee(()=>{document.addEventListener("click",Q)}),_t(()=>{document.removeEventListener("click",Q)}),(p,C)=>(l(),o("div",{ref_key:"selectRef",ref:g,class:ne(["v-select",{"v-select--disabled":p.disabled,"v-select--focused":A.value,"v-select--open":$.value,"v-select--error":p.error}]),tabindex:"0",onClick:T,onKeydown:R},[r("fieldset",tl,[p.label?(l(),o("legend",ll,i(p.label),1)):U("",!0)]),r("div",ol,[v.value?(l(),o("span",nl,i(v.value),1)):p.placeholder?(l(),o("span",sl,i(p.placeholder),1)):U("",!0)]),(l(),o("svg",{class:ne(["v-select__arrow",{"v-select__arrow--open":$.value}]),viewBox:"0 0 24 24"},C[0]||(C[0]=[r("path",{d:"M7 10L12 15L17 10",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)]),2)),(l(),q(ft,{to:"body"},[$.value?(l(),o("div",{key:0,ref_key:"menuRef",ref:M,class:"v-select-menu",style:yt(e.value)},[(l(!0),o(V,null,N(p.options,t=>(l(),o("div",{key:t.value,class:ne(["v-select-option",{"v-select-option--selected":t.value===p.modelValue,"v-select-option--disabled":t.disabled}]),onClick:I=>D(t)},[z(i(t.label)+" ",1),t.value===p.modelValue?(l(),o("svg",il,C[1]||(C[1]=[r("path",{d:"M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z",fill:"currentColor"},null,-1)]))):U("",!0)],10,al))),128))],4)):U("",!0)]))],34))}}),ul=be(dl,[["__scopeId","data-v-8f00dead"]]),rl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function cl(L,b){return l(),o("svg",rl,b[0]||(b[0]=[r("path",{fill:"currentColor",d:"M12 13.825L8.1 17.7q-.275.275-.687.288T6.7 17.7q-.275-.275-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.213t.375-.062t.375.062t.325.213l4.6 4.6q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275zm0-6L8.1 11.7q-.275.275-.687.288T6.7 11.7q-.275-.275-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.212T12 5.425t.375.063t.325.212l4.6 4.6q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275z"},null,-1)]))}const ml=ce({name:"material-symbols-keyboard-double-arrow-up-rounded",render:cl}),pl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function vl(L,b){return l(),o("svg",pl,b[0]||(b[0]=[r("path",{fill:"currentColor",d:"m12 16.175l3.9-3.875q.275-.275.688-.288t.712.288q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213l-4.6-4.6q-.275-.275-.288-.687T6.7 12.3q.275-.275.7-.275t.7.275zm0-6L15.9 6.3q.275-.275.688-.287t.712.287q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213L6.7 7.7q-.275-.275-.288-.687T6.7 6.3q.275-.275.7-.275t.7.275z"},null,-1)]))}const _l=ce({name:"material-symbols-keyboard-double-arrow-down-rounded",render:vl});function ee(L){return Array.from({length:L},(b,f)=>f+1).concat(-1)}const oe={phoneNumberTypes:ee(20),emailTypes:ee(4),addressTypes:ee(3),eventTypes:ee(3),imTypes:ee(8),websiteTypes:ee(7)},fl=X({__name:"PromptModal",props:{do:{type:Function,required:!0},title:{type:String,required:!0},value:{type:String,default:""}},setup(L){const{handleSubmit:b}=Fe(),f=F(),a=L,{value:g,resetField:M,errorMessage:$}=ze("inputValue",Be().required()),A=b(()=>{a.do(String(g.value||"")),Z()});return a.value?g.value=a.value:M(),Ee(async()=>{await De(),requestAnimationFrame(()=>{setTimeout(()=>{var e;try{document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),(e=f.value)==null||e.focus()}catch(v){console.debug("Focus blocked:",v)}},100)})}),(e,v)=>{const k=Oe,E=ge,T=Re,D=Pe;return l(),q(D,{onClose:s(Z)},{headline:h(()=>[z(i(L.title),1)]),content:h(()=>[c(k,{ref_key:"inputRef",ref:f,modelValue:s(g),"onUpdate:modelValue":v[0]||(v[0]=R=>gt(g)?g.value=R:null),class:"form-control",error:!!s($),"error-text":s($)?e.$t(s($)):"",onKeyup:bt(s(A),["enter"])},null,8,["modelValue","error","error-text","onKeyup"])]),actions:h(()=>[c(E,{value:"cancel",onClick:s(Z)},{default:h(()=>[z(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),c(T,{value:"ok",onClick:s(A)},{default:h(()=>[z(i(e.$t("ok")),1)]),_:1},8,["onClick"])]),_:1},8,["onClose"])}}}),yl={class:"form-label"},bl={class:"form-row"},gl={key:1,class:"v-center"},hl={key:0,class:"form-row"},$l={class:"v-center"},kl={class:"form-label"},Cl={class:"v-center"},wl=["onClick"],Vl={key:1,class:"form-label"},Tl={class:"v-center"},Il=["onClick"],Nl={key:2,class:"form-label"},ql={class:"v-center"},Ll=["onClick"],Sl={key:3,class:"form-label"},Ul={class:"v-center"},Ml=["onClick"],Al={key:4,class:"form-label"},El={class:"v-center"},Dl=["onClick"],Fl={class:"form-row",style:{display:"block",position:"relative"}},zl={class:"form-row"},Me=X({__name:"EditContactModal",props:{data:{type:Object,default:()=>({})},sources:{type:Array,default:()=>[]},done:{type:Function,default:()=>{}}},setup(L){const{handleSubmit:b}=Fe(),f=L,a=Ke({firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",nickname:"",organization:null,notes:"",source:"",starred:0,phoneNumbers:[],emails:[],addresses:[],websites:[],events:[],ims:[],groupIds:[]}),g=F(!1),M=F(!1),{t:$}=Qe(),{mutate:A,loading:e,onDone:v}=fe({document:ye`
    mutation createContact($input: ContactInput!) {
      createContact(input: $input) {
        ...ContactFragment
      }
    }
    ${Ne}
  `,options:{update:()=>{f.done()}}}),{mutate:k,loading:E,onDone:T}=fe({document:ye`
    mutation updateContact($id: ID!, $input: ContactInput!) {
      updateContact(id: $id, input: $input) {
        ...ContactFragment
      }
    }
    ${Ne}
  `,options:{update:()=>{f.done()}}}),{value:D,resetField:R,errorMessage:Q}=ze("inputValue",Be().test("required",n=>"valid.required",n=>!0).test("target-value",n=>"invalid_value",n=>!0)),p=(n,m)=>{n.splice(0,n.length);for(const y of m)n.push({label:y.label,value:y.value,type:y.type})};(()=>{const n=f.data;n?(Object.assign(a,{firstName:n.firstName,middleName:n.middleName,lastName:n.lastName,prefix:n.prefix,suffix:n.suffix,notes:n.notes}),p(a.phoneNumbers,n.phoneNumbers),p(a.emails,n.emails),p(a.addresses,n.addresses),p(a.websites,n.websites),p(a.events,n.events),p(a.ims,n.ims)):(Object.assign(a,{firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",notes:"",phoneNumbers:[{type:2,value:"",label:""}],emails:[],addresses:[],websites:[],events:[],ims:[]}),R())})();const C=n=>{n.type===-1&&$t(fl,{value:n.label,title:$("custom"),do:m=>{n.label=m}})},t=(n,m,y)=>m===-1?n.label?n.label:$("custom"):$(`contact.${y}.${m}`),I=(n,m,y)=>n.map(j=>({value:j,label:t(y,j,m)})),K=n=>{n.push({type:1,value:"",label:""}),M.value=!1},H=(n,m)=>{n.splice(m,1)},Y=b(()=>{var n,m;f.data?k({id:f.data.id,input:a}):(a.source=((m=(n=f.sources)==null?void 0:n[0])==null?void 0:m.name)??"",A({input:a}))});return v(()=>{Z()}),T(()=>{Z()}),(n,m)=>{const y=Oe,j=_l,me=ml,G=ul,W=he,se=ge,pe=ht,ae=Re,ie=Pe;return l(),q(ie,{onClose:s(Z)},{headline:h(()=>[z(i(L.data?n.$t("edit"):n.$t("create")),1)]),content:h(()=>[r("label",yl,i(n.$t("name")),1),r("div",bl,[c(y,{modelValue:a.firstName,"onUpdate:modelValue":m[0]||(m[0]=d=>a.firstName=d),label:n.$t("first_name")},null,8,["modelValue","label"]),g.value?(l(),q(y,{key:0,modelValue:a.middleName,"onUpdate:modelValue":m[1]||(m[1]=d=>a.middleName=d),label:n.$t("middle_name")},null,8,["modelValue","label"])):U("",!0),c(y,{modelValue:a.lastName,"onUpdate:modelValue":m[2]||(m[2]=d=>a.lastName=d),label:n.$t("last_name")},null,8,["modelValue","label"]),g.value?U("",!0):(l(),o("div",gl,[r("button",{class:"btn-icon",onClick:m[3]||(m[3]=d=>g.value=!0)},[c(j)])]))]),g.value?(l(),o("div",hl,[c(y,{modelValue:a.prefix,"onUpdate:modelValue":m[4]||(m[4]=d=>a.prefix=d),label:n.$t("prefix")},null,8,["modelValue","label"]),c(y,{modelValue:a.suffix,"onUpdate:modelValue":m[5]||(m[5]=d=>a.suffix=d),label:n.$t("suffix")},null,8,["modelValue","label"]),r("div",$l,[r("button",{class:"btn-icon",onClick:m[6]||(m[6]=d=>g.value=!1)},[c(me)])])])):U("",!0),r("label",kl,i(n.$t("phone_number")),1),(l(!0),o(V,null,N(a.phoneNumbers,(d,S)=>(l(),o("div",{key:S,class:"form-row"},[c(G,{modelValue:d.type,"onUpdate:modelValue":_=>d.type=_,modelModifiers:{number:!0},class:"flex-2",options:I(s(oe).phoneNumberTypes,"phone_number_type",d),onChange:_=>C(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":_=>d.value=_,placeholder:n.$t("telephone"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),r("div",Cl,[a.phoneNumbers.length>1?(l(),o("button",{key:0,class:"btn-icon",onClick:_=>H(a.phoneNumbers,S)},[c(W)],8,wl)):U("",!0)])]))),128)),a.emails.length?(l(),o("label",Vl,i(n.$t("email")),1)):U("",!0),(l(!0),o(V,null,N(a.emails,(d,S)=>(l(),o("div",{key:S,class:"form-row"},[c(G,{modelValue:d.type,"onUpdate:modelValue":_=>d.type=_,modelModifiers:{number:!0},class:"flex-2",options:I(s(oe).emailTypes,"email_type",d),onChange:_=>C(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":_=>d.value=_,label:n.$t("email"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","label"]),r("div",Tl,[r("button",{class:"btn-icon",onClick:_=>H(a.emails,S)},[c(W)],8,Il)])]))),128)),a.addresses.length?(l(),o("label",Nl,i(n.$t("address")),1)):U("",!0),(l(!0),o(V,null,N(a.addresses,(d,S)=>(l(),o("div",{key:S,class:"form-row"},[c(G,{modelValue:d.type,"onUpdate:modelValue":_=>d.type=_,modelModifiers:{number:!0},class:"flex-2",options:I(s(oe).addressTypes,"address_type",d),onChange:_=>C(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":_=>d.value=_,label:n.$t("address"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","label"]),r("div",ql,[r("button",{class:"btn-icon",onClick:_=>H(a.addresses,S)},[c(W)],8,Ll)])]))),128)),a.websites.length?(l(),o("label",Sl,i(n.$t("website")),1)):U("",!0),(l(!0),o(V,null,N(a.websites,(d,S)=>(l(),o("div",{key:S,class:"form-row"},[c(G,{modelValue:d.type,"onUpdate:modelValue":_=>d.type=_,modelModifiers:{number:!0},class:"flex-2",options:I(s(oe).websiteTypes,"website_type",d),onChange:_=>C(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":_=>d.value=_,placeholder:n.$t("website"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),r("div",Ul,[r("button",{class:"btn-icon",onClick:_=>H(a.websites,S)},[c(W)],8,Ml)])]))),128)),a.ims.length?(l(),o("label",Al,i(n.$t("im")),1)):U("",!0),(l(!0),o(V,null,N(a.ims,(d,S)=>(l(),o("div",{key:S,class:"form-row"},[c(G,{modelValue:d.type,"onUpdate:modelValue":_=>d.type=_,modelModifiers:{number:!0},class:"flex-2",options:I(s(oe).imTypes,"im_type",d),onChange:_=>C(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":_=>d.value=_,placeholder:n.$t("im"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),r("div",El,[r("button",{class:"btn-icon",onClick:_=>H(a.ims,S)},[c(W)],8,Dl)])]))),128)),r("div",Fl,[c(pe,{modelValue:M.value,"onUpdate:modelValue":m[12]||(m[12]=d=>M.value=d),placement:"auto",align:"top-left-to-bottom-left"},{trigger:h(()=>[c(se,null,{default:h(()=>[z(i(n.$t("add_field")),1)]),_:1})]),default:h(()=>[r("div",{class:"dropdown-item",onClick:m[7]||(m[7]=()=>K(a.phoneNumbers))},i(n.$t("phone_number")),1),r("div",{class:"dropdown-item",onClick:m[8]||(m[8]=()=>K(a.emails))},i(n.$t("email")),1),r("div",{class:"dropdown-item",onClick:m[9]||(m[9]=()=>K(a.addresses))},i(n.$t("address")),1),r("div",{class:"dropdown-item",onClick:m[10]||(m[10]=()=>K(a.websites))},i(n.$t("website")),1),r("div",{class:"dropdown-item",onClick:m[11]||(m[11]=()=>K(a.ims))},i(n.$t("im")),1)]),_:1},8,["modelValue"])]),r("div",zl,[c(y,{modelValue:a.notes,"onUpdate:modelValue":m[13]||(m[13]=d=>a.notes=d),type:"textarea",label:n.$t("notes"),rows:3},null,8,["modelValue","label"])])]),actions:h(()=>[c(se,{value:"cancel",onClick:s(Z)},{default:h(()=>[z(i(n.$t("cancel")),1)]),_:1},8,["onClick"]),c(ae,{value:"save",loading:s(e)||s(E),onClick:s(Y)},{default:h(()=>[z(i(n.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),Bl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Rl(L,b){return l(),o("svg",Bl,b[0]||(b[0]=[r("path",{fill:"currentColor",d:"M12 14q.825 0 1.413-.587T14 12t-.587-1.412T12 10t-1.412.588T10 12t.588 1.413T12 14m-4 4h8v-.575q0-.6-.325-1.1t-.9-.75q-.65-.275-1.338-.425T12 15t-1.437.15t-1.338.425q-.575.25-.9.75T8 17.425zm10 4H6q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h7.175q.4 0 .763.15t.637.425l4.85 4.85q.275.275.425.638t.15.762V20q0 .825-.587 1.413T18 22m0-2V8.85L13.15 4H6v16zM6 20V4z"},null,-1)]))}const Ol=ce({name:"material-symbols-contact-page-outline-rounded",render:Rl}),Pl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Kl(L,b){return l(),o("svg",Pl,b[0]||(b[0]=[r("path",{fill:"currentColor",d:"M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"},null,-1)]))}const Ql=ce({name:"material-symbols-edit",render:Kl}),jl={class:"actions"},Ae=X({__name:"ContactActionButtons",props:{item:{}},emits:["deleteItem","edit","addItemToTags"],setup(L,{emit:b}){const f=L,a=b;function g(){a("deleteItem",f.item)}function M(){a("edit",f.item)}function $(){a("addItemToTags",f.item)}return(A,e)=>{const v=he,k=ke,E=Ql,T=je,D=$e("tooltip");return l(),o("div",jl,[P((l(),q(k,{onClick:B(g,["stop"])},{default:h(()=>[c(v)]),_:1})),[[D,A.$t("delete")]]),P((l(),q(k,{onClick:B(M,["stop"])},{default:h(()=>[c(E)]),_:1})),[[D,A.$t("edit")]]),P((l(),q(k,{onClick:B($,["stop"])},{default:h(()=>[c(T)]),_:1})),[[D,A.$t("add_to_tags")]])])}}}),Hl={class:"start"},Gl={class:"number"},Wl=["src"],Jl={class:"title"},Zl={class:"subtitle"},Xl={key:0},Yl={class:"info"},xl={class:"list-unstyled"},eo={class:"time"},to=["src"],lo={class:"subtitle"},oo={key:0},no={class:"info"},so={class:"list-unstyled"},ao={class:"time"},io=X({__name:"ContactListItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},dataType:{},callLoading:{type:Boolean},callId:{},callIndex:{},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function}},emits:["deleteItem","edit","addItemToTags","call"],setup(L,{emit:b}){const f=b;function a(e){f("deleteItem",e)}function g(e){f("edit",e)}function M(e){f("addItemToTags",e)}function $(e,v,k){f("call",e,v,k)}function A(e){let v="";re(e.firstName)||re(e.lastName)?v=`${e.lastName}${e.middleName}${e.firstName}`:v=[e.firstName,e.middleName,e.lastName].filter(T=>T).join(" ");const k=e.suffix?`, ${e.suffix}`:"",E=`${e.prefix} ${v} ${k}`.trim();return E||(e.emails.length?e.emails[0].value:"")}return(e,v)=>{const k=He,E=Zt,T=Ol,D=kt,R=Jt,Q=ke,p=Wt,C=$e("tooltip");return e.isPhone?(l(),q(p,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:v[4]||(v[4]=t=>e.handleItemClick(t,e.item,e.index,()=>{})),onMouseenter:v[5]||(v[5]=B(t=>e.handleMouseOver(t,e.index),["stop"])),onCheckboxClick:v[6]||(v[6]=t=>e.toggleSelect(t,e.item,e.index))},{image:h(()=>[e.item.thumbnailId?(l(),o("img",{key:0,class:"image",src:s(qe)(e.item.thumbnailId),width:"50"},null,8,to)):(l(),q(T,{key:1,class:"image"}))]),title:h(()=>[z(i(A(e.item)),1)]),subtitle:h(()=>[r("div",lo,[e.item.notes?(l(),o("span",oo,i(e.item.notes),1)):U("",!0),c(D,{tags:e.item.tags,type:e.dataType,"only-links":!0},null,8,["tags","type"])]),r("div",no,[r("ul",so,[(l(!0),o(V,null,N(e.item.phoneNumbers,(t,I)=>(l(),o("li",{key:I,class:"phone-number"},[z(i(t.type>0?e.$t(`contact.phone_number_type.${t.type}`):t.label)+" "+i(t.normalizedNumber||t.value)+" ",1),P((l(),q(Q,{loading:e.callLoading&&e.callId===e.item.id&&e.callIndex===I,onClick:B(K=>$(e.item.id,t.normalizedNumber||t.value,I),["stop"])},{default:h(()=>[c(R)]),_:2},1032,["loading","onClick"])),[[C,e.$t("make_a_phone_call")]])]))),128)),(l(!0),o(V,null,N(e.item.emails,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.email_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,N(e.item.addresses,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.address_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,N(e.item.websites,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.website_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,N(e.item.ims,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.im_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,N(e.item.events,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.event_type.${t.type}`):t.label)+" "+i(t.value),1))),128))])]),r("div",ao,[P((l(),o("span",null,[z(i(s(Se)(e.item.updatedAt)),1)])),[[C,s(Le)(e.item.updatedAt)]])])]),actions:h(()=>[c(Ae,{item:e.item,onDeleteItem:a,onEdit:g,onAddItemToTags:M},null,8,["item"])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(l(),o("section",{key:0,class:ne(["contact-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:v[2]||(v[2]=B(t=>e.handleItemClick(t,e.item,e.index,()=>{}),["stop"])),onMouseenter:v[3]||(v[3]=B(t=>e.handleMouseOver(t,e.index),["stop"]))},[r("div",Hl,[e.shiftEffectingIds.includes(e.item.id)?(l(),q(k,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:v[0]||(v[0]=B(t=>e.toggleSelect(t,e.item,e.index),["stop"]))},null,8,["checked"])):(l(),q(k,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:v[1]||(v[1]=B(t=>e.toggleSelect(t,e.item,e.index),["stop"]))},null,8,["checked"])),r("span",Gl,[c(E,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),e.item.thumbnailId?(l(),o("img",{key:0,class:"image",src:s(qe)(e.item.thumbnailId),width:"50"},null,8,Wl)):(l(),q(T,{key:1,class:"image"})),r("div",Jl,i(A(e.item)),1),r("div",Zl,[e.item.notes?(l(),o("span",Xl,i(e.item.notes),1)):U("",!0),c(D,{tags:e.item.tags,type:e.dataType,"only-links":!0},null,8,["tags","type"])]),r("div",Yl,[r("ul",xl,[(l(!0),o(V,null,N(e.item.phoneNumbers,(t,I)=>(l(),o("li",{key:I,class:"phone-number"},[z(i(t.type>0?e.$t(`contact.phone_number_type.${t.type}`):t.label)+" "+i(t.normalizedNumber||t.value)+" ",1),P((l(),q(Q,{loading:e.callLoading&&e.callId===e.item.id&&e.callIndex===I,onClick:B(K=>$(e.item.id,t.normalizedNumber||t.value,I),["stop"])},{default:h(()=>[c(R)]),_:2},1032,["loading","onClick"])),[[C,e.$t("make_a_phone_call")]])]))),128)),(l(!0),o(V,null,N(e.item.emails,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.email_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,N(e.item.addresses,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.address_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,N(e.item.websites,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.website_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,N(e.item.ims,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.im_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,N(e.item.events,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.event_type.${t.type}`):t.label)+" "+i(t.value),1))),128))])]),c(Ae,{item:e.item,onDeleteItem:a,onEdit:g,onAddItemToTags:M},null,8,["item"]),r("div",eo,[P((l(),o("span",null,[z(i(s(Se)(e.item.updatedAt)),1)])),[[C,s(Le)(e.item.updatedAt)]])])],34))}}}),uo=be(io,[["__scopeId","data-v-a4d9bd26"]]),ro={class:"top-app-bar"},co={class:"title"},mo={key:0},po={key:1},vo={class:"actions"},_o={class:"scroll-content"},fo={key:0,class:"no-data-placeholder"},te=50,yo=X({__name:"ContactsView",setup(L){const b=Ft("isPhone"),f=Ct(),{app:a}=wt(Vt()),g=F([]),{t:M}=Qe(),{parseQ:$}=Kt(),A=Ke({tagIds:[]}),e=Tt.CONTACT,v=zt(),k=F(1),E=F([]),T=F(""),{tags:D,fetch:R}=Ht(e),{addToTags:Q}=Gt(e,D),{deleteItems:p}=rt(Qt,()=>{Y(),_(),x.emit("refetch_tags",e)}),{selectedIds:C,allChecked:t,realAllChecked:I,selectRealAll:K,allCheckedAlertVisible:H,clearSelection:Y,toggleAllChecked:n,toggleSelect:m,total:y,checked:j,shiftEffectingIds:me,handleItemClick:G,handleMouseOver:W,selectAll:se,shouldSelect:pe}=ct(g),ae=u=>{const w=v.query.q;Bt(f,w?`/contacts?page=${u}&q=${w}`:`/contacts?page=${u}`)},{keyDown:ie,keyUp:d}=mt(y,te,k,se,Y,ae,()=>{p(C.value,I.value,y.value,T.value)}),{loading:S,fetch:_}=It({handle:(u,w)=>{w?Ue(M(w),"error"):u&&(g.value=u.contacts,y.value=u.contactCount)},document:Mt,variables:()=>({offset:(k.value-1)*te,limit:te,query:T.value})});Nt({handle:(u,w)=>{w?Ue(M(w),"error"):u&&(E.value=u.contactSources)},document:At,variables:null});const Ce=u=>{u.type===e&&(Y(),_())},we=u=>{u.type===e&&_()};function Ge(u){ue(Rt,{type:e,tags:D.value,item:{key:u.id,title:"",size:0},selected:D.value.filter(w=>u.tags.some(O=>O.id===w.id))})}function We(u){let w="";re(u.firstName)||re(u.lastName)?w=`${u.lastName}${u.middleName}${u.firstName}`:w=[u.firstName,u.middleName,u.lastName].filter(le=>le).join(" ");const O=u.suffix?`, ${u.suffix}`:"",de=`${u.prefix} ${w} ${O}`.trim();return de||(u.emails.length?u.emails[0].value:"")}function Je(u){ue(Ot,{id:u.id,name:We(u),gql:ye`
      mutation DeleteContact($query: String!) {
        deleteContacts(query: $query)
      }
    `,variables:()=>({query:`ids:${u.id}`}),typeName:"Contact",done:()=>{y.value--,u.tags.length&&x.emit("refetch_tags",e)}})}function Ze(u){ue(Me,{data:u,sources:E,done:_})}function Xe(){ue(Me,{data:null,sources:E,done:_})}const Ve=F(""),Te=F(0),{mutate:Ye,loading:xe}=fe({document:Et});function et(u,w,O){Ve.value=u,Te.value=O,Ye({number:w})}const ve=F(!1);function Ie(){var w,O;const u=parseInt(((w=v.query.page)==null?void 0:w.toString())??"1");k.value=Number.isFinite(u)&&u>0?u:1,T.value=Pt(((O=v.query.q)==null?void 0:O.toString())??""),$(A,T.value),_()}return qt(()=>v.fullPath,()=>{ve.value&&Ie()}),Lt(()=>{R(),ve.value=!0,Ie(),x.on("item_tags_updated",we),x.on("items_tags_updated",Ce),window.addEventListener("keydown",ie),window.addEventListener("keyup",d)}),St(()=>{ve.value=!1,x.off("item_tags_updated",we),x.off("items_tags_updated",Ce),window.removeEventListener("keydown",ie),window.removeEventListener("keyup",d)}),(u,w)=>{const O=He,de=he,le=ke,tt=Dt,lt=je,ot=ge,nt=jt,st=el,at=dt,_e=$e("tooltip");return l(),o(V,null,[r("div",ro,[c(O,{"touch-target":"wrapper",checked:s(t),indeterminate:!s(t)&&s(j),onChange:s(n)},null,8,["checked","indeterminate","onChange"]),r("div",co,[s(C).length?(l(),o("span",mo,i(u.$t("x_selected",{count:s(I)?s(y).toLocaleString():s(C).length.toLocaleString()})),1)):(l(),o("span",po,i(u.$t("page_title.contacts"))+" ("+i(s(y).toLocaleString())+")",1)),s(j)?(l(),o(V,{key:2},[P((l(),q(le,{onClick:w[0]||(w[0]=B(J=>s(p)(s(C),s(I),s(y),T.value),["stop"]))},{default:h(()=>[c(de)]),_:1})),[[_e,u.$t("delete")]]),P((l(),q(le,{style:{display:"none"}},{default:h(()=>[c(tt)]),_:1})),[[_e,u.$t("download")]]),P((l(),q(le,{onClick:w[1]||(w[1]=B(J=>s(Q)(s(C),s(I),T.value),["stop"]))},{default:h(()=>[c(lt)]),_:1})),[[_e,u.$t("add_to_tags")]])],64)):U("",!0)]),r("div",vo,[c(ot,{class:"btn-sm",onClick:Xe},{default:h(()=>[z(i(u.$t("create")),1)]),_:1})])]),c(nt,{limit:te,total:s(y),"all-checked-alert-visible":s(H),"real-all-checked":s(I),"select-real-all":s(K),"clear-selection":s(Y)},null,8,["total","all-checked-alert-visible","real-all-checked","select-real-all","clear-selection"]),r("div",_o,[r("div",{class:ne(["main-list",{"select-mode":s(j)}])},[(l(!0),o(V,null,N(g.value,(J,it)=>(l(),q(uo,{key:J.id,item:J,index:it,"selected-ids":s(C),"shift-effecting-ids":s(me),"should-select":s(pe),"is-phone":s(b),"data-type":s(e),"call-loading":s(xe),"call-id":Ve.value,"call-index":Te.value,"handle-item-click":s(G),"handle-mouse-over":s(W),"toggle-select":s(m),onDeleteItem:Je,onEdit:Ze,onAddItemToTags:Ge,onCall:et},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","data-type","call-loading","call-id","call-index","handle-item-click","handle-mouse-over","toggle-select"]))),128)),s(S)&&g.value.length===0?(l(),o(V,{key:0},N(20,J=>c(st,{key:J,index:J,"is-phone":s(b)},null,8,["index","is-phone"])),64)):U("",!0)],2),!s(S)&&g.value.length===0?(l(),o("div",fo,i(u.$t(s(Ut)(s(S),s(a).permissions,"WRITE_CONTACTS"))),1)):U("",!0),s(y)>te?(l(),q(at,{key:1,page:k.value,go:ae,total:s(y),limit:te},null,8,["page","total"])):U("",!0)])],64)}}}),Io=be(yo,[["__scopeId","data-v-3094d28c"]]);export{Io as default};
