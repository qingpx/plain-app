import{_ as we}from"./ListItemPhone.vuevuetypescriptsetuptruelang-Bqw8QMbP.js";import{e as R,c as a,K as m,o,z as u,O as be,a as l,k as p,bz as C,l as t,aH as J,t as d,L as y,n as W,M as j,R as X,H as A,S as Y,G as q,q as r,ak as x,by as Ee,bY as $e,J as ee,d as Fe,u as Se,r as F,g as Ce,s as Te,i as De,aw as Le,W as Ve,X as Ae,Y as Re,j as S,Z,$ as Me,bZ as Pe,br as ze,a0 as Be,bN as Ne,b_ as Oe,F as Ue,bM as Ke,bS as He,at as Ge,bT as Qe,bU as Je,bP as We,a5 as I,bV as Xe}from"./index-BoXfNRGv.js";import{_ as Ye}from"./FieldId.vuevuetypescriptsetuptruelang-AXTM3mJl.js";import{_ as se}from"./VCheckbox-C2EQufpw.js";import{_ as Ze,u as je,c as qe}from"./key-events-OT4soXUo.js";const xe={class:"start"},es={class:"number"},ss={key:0,class:"svg",src:C},ts=["src"],ns=["src"],os={key:3,class:"svg",src:C},is={class:"title"},ls={class:"subtitle"},as={class:"actions"},ds={class:"card card-info"},rs={class:"key-value vertical"},cs={class:"key"},ms={class:"value"},us={key:0,class:"svg",src:C},ps=["src"],vs=["src"],gs={key:3,class:"svg",src:C},fs={class:"actions"},hs={class:"card card-info"},ks={class:"key-value vertical"},_s={class:"key"},ys={class:"value"},Is=R({__name:"FileRecentItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},imageErrorIds:{},extensionImageErrorIds:{},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function},onImageError:{type:Function},onExtensionImageError:{type:Function},downloadFile:{type:Function},clickItem:{type:Function}},setup(M){return(e,s)=>{const v=se,w=Ye,b=x,g=q,c=Ee,h=$e,E=we,f=j("tooltip");return e.isPhone?(o(),m(E,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:s[12]||(s[12]=i=>e.handleItemClick(i,e.item,e.index,()=>e.clickItem(e.item))),onMouseenter:s[13]||(s[13]=u(i=>e.handleMouseOver(i,e.index),["stop"])),onCheckboxClick:s[14]||(s[14]=i=>e.toggleSelect(i,e.item,e.index))},{image:r(()=>[l("div",{class:"image",onClick:s[10]||(s[10]=u(i=>e.clickItem(e.item),["stop"]))},[e.extensionImageErrorIds.includes(e.item.id)?(o(),a("img",us)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),a("img",{key:1,class:"image-thumb",src:t(J)(e.item.fileId,"&w=50&h=50"),onError:s[8]||(s[8]=i=>e.onImageError(e.item.id))},null,40,ps)):e.item.extension?(o(),a("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:s[9]||(s[9]=i=>e.onExtensionImageError(e.item.id))},null,40,vs)):(o(),a("img",gs))])]),title:r(()=>[A(d(e.item.name),1)]),subtitle:r(()=>[l("span",null,d(t(W)(e.item.size)),1),y((o(),a("span",null,[A(d(t(Y)(e.item.updatedAt)),1)])),[[f,t(X)(e.item.updatedAt)]])]),actions:r(()=>[l("div",fs,[y((o(),m(g,{onClick:s[11]||(s[11]=u(i=>e.downloadFile(e.item.path),["stop"]))},{default:r(()=>[p(b)]),_:1})),[[f,e.$t("download")]]),p(h,null,{content:r(()=>[l("section",hs,[l("div",ks,[l("div",_s,d(e.$t("path")),1),l("div",ys,d(e.item.path),1)])])]),default:r(()=>[y((o(),m(g,null,{default:r(()=>[p(c)]),_:1})),[[f,e.$t("info")]])]),_:1})])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(o(),a("section",{key:0,class:be(["file-item recent-file-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:s[6]||(s[6]=u(i=>e.handleItemClick(i,e.item,e.index,()=>e.clickItem(e.item)),["stop"])),onMouseenter:s[7]||(s[7]=u(i=>e.handleMouseOver(i,e.index),["stop"]))},[l("div",xe,[e.shiftEffectingIds.includes(e.item.id)?(o(),m(v,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:s[0]||(s[0]=u(i=>e.toggleSelect(i,e.item,e.index),["stop"]))},null,8,["checked"])):(o(),m(v,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:s[1]||(s[1]=u(i=>e.toggleSelect(i,e.item,e.index),["stop"]))},null,8,["checked"])),l("span",es,[p(w,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),l("div",{class:"image",onClick:s[4]||(s[4]=u(i=>e.clickItem(e.item),["stop"]))},[e.extensionImageErrorIds.includes(e.item.id)?(o(),a("img",ss)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),a("img",{key:1,class:"image-thumb",src:t(J)(e.item.fileId,"&w=50&h=50"),onError:s[2]||(s[2]=i=>e.onImageError(e.item.id))},null,40,ts)):e.item.extension?(o(),a("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:s[3]||(s[3]=i=>e.onExtensionImageError(e.item.id))},null,40,ns)):(o(),a("img",os))]),l("div",is,d(e.item.name),1),l("div",ls,[l("span",null,d(t(W)(e.item.size)),1),y((o(),a("span",null,[A(d(t(Y)(e.item.updatedAt)),1)])),[[f,t(X)(e.item.updatedAt)]])]),l("div",as,[y((o(),m(g,{onClick:s[5]||(s[5]=u(i=>e.downloadFile(e.item.path),["stop"]))},{default:r(()=>[p(b)]),_:1})),[[f,e.$t("download")]]),p(h,null,{content:r(()=>[l("section",ds,[l("div",rs,[l("div",cs,d(e.$t("path")),1),l("div",ms,d(e.item.path),1)])])]),default:r(()=>[y((o(),m(g,null,{default:r(()=>[p(c)]),_:1})),[[f,e.$t("info")]])]),_:1})])],34))}}}),ws=ee(Is,[["__scopeId","data-v-7ca2e29e"]]),bs={key:0,class:"file-item recent-file-item selectable-card-skeleton"},Es={class:"start"},$s={class:"number"},Fs=R({__name:"FileRecentSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(M){return(e,s)=>{const v=Ze;return e.isPhone?(o(),m(v,{key:1,"title-width":"60%",subtitles:[{width:"45%"},{width:"40%"}],"action-count":2})):(o(),a("section",bs,[l("div",Es,[s[0]||(s[0]=l("div",{class:"skeleton-checkbox"},null,-1)),l("span",$s,d(e.index),1)]),s[1]||(s[1]=Fe('<div class="image" data-v-777f0631><div class="skeleton-image lg" data-v-777f0631></div></div><div class="title" data-v-777f0631><div class="skeleton-text lg" style="width:40%;" data-v-777f0631></div></div><div class="subtitle" data-v-777f0631><div class="skeleton-text" style="width:30%;" data-v-777f0631></div></div><div class="actions" data-v-777f0631><div class="skeleton-text lg" style="width:80px;" data-v-777f0631></div></div>',4))]))}}}),Ss=ee(Fs,[["__scopeId","data-v-777f0631"]]),Cs={class:"top-app-bar"},Ts={key:0},Ds={key:1},Ls={key:0,class:"scroller main-list"},Vs={key:2,class:"no-data-placeholder"},Bs=R({__name:"FilesRecentView",setup(M){const{t:e}=Se(),s=F([]),v=Pe(),w=Ce(),{app:b,urlTokenKey:g}=Te(w),c=F([]),{selectedIds:h,allChecked:E,realAllChecked:f,clearSelection:i,toggleAllChecked:te,toggleSelect:ne,total:T,checked:P,shiftEffectingIds:oe,handleItemClick:ie,handleMouseOver:le,selectAll:ae,shouldSelect:de}=je(c),{downloadFile:z,downloadFiles:re}=Le(g),{view:ce}=Je(s,(n,k)=>{w.lightbox={sources:n,index:k,visible:!0}}),{keyDown:B,keyUp:N}=qe(ae,i,()=>{}),O=F([]),U=F([]),me=n=>{O.value.push(n)},ue=n=>{U.value.push(n)},{mutate:pe,onDone:ve}=De({document:Ne});ve(n=>{re(n.data.setTempValue.key),i()});const ge=n=>{He(n.name)?window.open(Ge(g.value,n.path),"_blank"):Qe(n.name)?ce(c.value,n):z(n.path)},{loading:D,fetch:L}=Ve({handle:async(n,k)=>{if(k)Ue(e(k),"error");else{const _=[];for(const V of n.recentFiles)_.push(Ke(V,g.value));c.value=_,T.value=_.length}},document:Oe}),fe=()=>{pe({key:We(),value:JSON.stringify(h.value.map(n=>({path:n})))})},K=n=>{n.status==="done"&&setTimeout(()=>{L()},1e3)},he=n=>{n.forEach(k=>{Xe(c.value,_=>_.id===k.id)}),i()},H=n=>{he([n.item])},G=n=>{L()};return Ae(()=>{L(),I.on("upload_task_done",K),I.on("file_deleted",H),I.on("file_renamed",G),window.addEventListener("keydown",B),window.addEventListener("keyup",N)}),Re(()=>{I.off("upload_task_done",K),I.off("file_deleted",H),I.off("file_renamed",G),window.removeEventListener("keydown",B),window.removeEventListener("keyup",N)}),(n,k)=>{const _=se,V=x,ke=q,_e=Ss,ye=ws,Ie=j("tooltip");return o(),a(Z,null,[l("div",Cs,[p(_,{"touch-target":"wrapper",checked:t(E),indeterminate:!t(E)&&t(P),onChange:t(te)},null,8,["checked","indeterminate","onChange"]),t(h).length?(o(),a("span",Ts,d(n.$t("x_selected",{count:t(f)?t(T).toLocaleString():t(h).length.toLocaleString()})),1)):(o(),a("span",Ds,d(n.$t("recent_files"))+" ("+d(t(T).toLocaleString())+")",1)),t(P)?y((o(),m(ke,{key:2,onClick:u(fe,["stop"])},{default:r(()=>[p(V)]),_:1})),[[Ie,n.$t("download")]]):S("",!0)]),t(D)&&c.value.length===0?(o(),a("div",Ls,[(o(),a(Z,null,Me(20,$=>p(_e,{key:$,index:$,"is-phone":t(v)},null,8,["index","is-phone"])),64))])):S("",!0),c.value.length>0?(o(),m(t(ze),{key:1,class:"scroller main-list","data-key":"id","data-sources":c.value,"estimate-size":t(v)?120:80},{item:r(({index:$,item:Q})=>[(o(),m(ye,{key:Q.id,item:Q,index:$,"selected-ids":t(h),"shift-effecting-ids":t(oe),"should-select":t(de),"is-phone":t(v),"image-error-ids":O.value,"extension-image-error-ids":U.value,"handle-item-click":t(ie),"handle-mouse-over":t(le),"toggle-select":t(ne),"on-image-error":me,"on-extension-image-error":ue,"download-file":t(z),"click-item":ge},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","image-error-ids","extension-image-error-ids","handle-item-click","handle-mouse-over","toggle-select","download-file"]))]),_:1},8,["data-sources","estimate-size"])):S("",!0),!t(D)&&c.value.length===0?(o(),a("div",Vs,d(n.$t(t(Be)(t(D),t(b).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):S("",!0)],64)}}});export{Bs as default};
