import{e as w,az as G,r as $,aA as N,cx as E,i as b,cy as H,cz as J,K as k,o as m,q as i,k as v,H as f,t as c,l as o,aC as y,aj as K,A as O,a as p,L as R,O as C,c as W,$ as Z,bD as x,Z as P,bA as U,aq as X,aE as Y,a5 as q,bV as ee,J as ae,u as h,W as te,bj as se,F as A,a2 as oe}from"./index-Bu4wgWbt.js";const ne={class:"button-group"},le=w({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(d){const{handleSubmit:_}=G(),t=$("add_to_tags"),a=d,{value:s,errorMessage:n}=N("selectedTags",E().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:l,loading:g,onDone:D}=b({document:H}),{mutate:F,loading:L,onDone:M}=b({document:J}),T=()=>{q.emit("items_tags_updated",{type:a.type}),q.emit("refetch_tags",a.type),y()};M(T),D(T);function S(e){s.value.includes(e)?ee(s.value,r=>r.id===e.id):s.value.push(e)}const V=_(()=>{t.value==="add_to_tags"?F({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query}):l({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query})});return(e,r)=>{const z=x,B=U,I=K,Q=O,j=Y;return m(),k(j,{onClose:o(y)},{headline:i(()=>[f(c(e.$t("tags")),1)]),content:i(()=>[p("div",ne,[p("button",{class:C({selected:t.value==="add_to_tags"}),onClick:r[0]||(r[0]=u=>t.value="add_to_tags")},c(e.$t("add_to_tags")),3),p("button",{class:C({selected:t.value==="remove_from_tags"}),onClick:r[1]||(r[1]=u=>t.value="remove_from_tags")},c(e.$t("remove_from_tags")),3)]),v(B,null,{default:i(()=>[(m(!0),W(P,null,Z(d.tags,u=>(m(),k(z,{key:u.id,label:u.name,selected:o(s).includes(u),onClick:re=>S(u)},null,8,["label","selected","onClick"]))),128))]),_:1}),R(p("div",{class:"invalid-feedback"},c(o(n)?e.$t(o(n)):""),513),[[X,o(n)]])]),actions:i(()=>[v(I,{value:"cancel",onClick:o(y)},{default:i(()=>[f(c(e.$t("cancel")),1)]),_:1},8,["onClick"]),v(Q,{value:"save",loading:o(L)||o(g),onClick:o(V)},{default:i(()=>[f(c(e.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),de=ae(le,[["__scopeId","data-v-8725492b"]]),ie=(d,_)=>{const{t}=h();return{addToTags:(a,s,n)=>{let l=n;if(!s){if(a.length===0){A(t("select_first"),"error");return}l=`ids:${a.join(",")}`}oe(de,{type:d,tags:_.value,query:l})}}},ce=(d,_=()=>{})=>{const t=$([]),{t:a}=h(),{loading:s,fetch:n}=te({handle:async(l,g)=>{g?A(a(g),"error"):l&&(t.value=l.tags,_())},document:se,variables:{type:d}});return{tags:t,loading:s,fetch:n}};export{ie as a,ce as u};
