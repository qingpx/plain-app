import{_ as N}from"./VDropdownMenu-D-WZ4Jxr.js";import{_ as K}from"./more-vert-Bnq9WcmR.js";import{m as U,c as m,o as s,a as n,e as j,u as x,f as A,r as _,h as O,bj as P,F as R,ae as Z,a5 as u,af as J,k as v,t as d,L as b,M as W,K as q,G as X,z as g,q as f,Z as M,$ as Y,O as ee,a2 as h,bK as V,ac as te,C as ae,B as ne,cn as oe,D as se,i as B,co as ie,cp as le,cq as de}from"./index-BCT-9m6o.js";const re={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ce(p,o){return s(),m("svg",re,o[0]||(o[0]=[n("path",{fill:"currentColor",d:"M11 13H6q-.425 0-.712-.288T5 12t.288-.712T6 11h5V6q0-.425.288-.712T12 5t.713.288T13 6v5h5q.425 0 .713.288T19 12t-.288.713T18 13h-5v5q0 .425-.288.713T12 19t-.712-.288T11 18z"},null,-1)]))}const ue=U({name:"material-symbols-add-rounded",render:ce}),me={class:"top-app-bar"},pe={class:"title"},_e={class:"actions"},ve={class:"nav"},ge=["onClick"],fe={class:"title"},he={class:"count"},$e=j({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(p){const o=p,{t:i}=x(),L=A(),y=_([]),l=_(!1),r=_(),{refetch:c}=O({handle:(e,t)=>{t?R(i(t),"error"):e&&(y.value=e.tags)},document:P,variables:{type:o.type}});function E(e){r.value=e;const t=document.getElementById("tag-"+e.id);document.dispatchEvent(new CustomEvent("dropdown-toggle",{detail:{exclude:t}})),l.value=!0}function Q(e){h(V,{title:i("rename"),placeholder:i("name"),value:e.name,mutation:()=>B({document:ie}),getVariables:t=>({id:e.id,name:t}),done:()=>{c()}})}function S(e){h(te,{id:e.id,name:e.name,gql:le,typeName:"Tag"})}function D(){h(V,{title:i("add_tag"),placeholder:i("name"),mutation:()=>B({document:de,options:{update:()=>{c()}}}),getVariables:e=>({type:o.type,name:e})})}function G(e){const t=ae([{name:"tag_id",op:"",value:e.id}]);ne(L,`/${oe[o.type]}?q=${se(t)}`)}const T=e=>{e===o.type&&c()},C=e=>{e.type===o.type&&c()};return Z(()=>{u.on("refetch_tags",T),u.on("media_items_actioned",C)}),J(()=>{u.off("refetch_tags",T),u.off("media_items_actioned",C)}),(e,t)=>{var w;const I=ue,$=X,z=K,F=N,k=W("tooltip");return s(),m(M,null,[n("div",me,[n("div",pe,d(e.$t("tags")),1),n("div",_e,[b((s(),q($,{onClick:g(D,["prevent"])},{default:f(()=>[v(I)]),_:1})),[[k,e.$t("add_tag")]])])]),n("ul",ve,[(s(!0),m(M,null,Y(y.value,a=>(s(),m("li",{key:a.id,class:ee({active:a.id===p.selected}),onClick:g(H=>G(a),["prevent"])},[n("span",fe,d(a.name),1),b((s(),q($,{id:"tag-"+a.id,class:"sm",onClick:g(H=>E(a),["prevent","stop"])},{default:f(()=>[v(z)]),_:2},1032,["id","onClick"])),[[k,e.$t("actions")]]),n("span",he,d(a.count.toLocaleString()),1)],10,ge))),128))]),v(F,{modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=a=>l.value=a),anchor:"tag-"+((w=r.value)==null?void 0:w.id)},{default:f(()=>[n("div",{class:"dropdown-item",onClick:t[0]||(t[0]=a=>{Q(r.value),l.value=!1})},d(e.$t("rename")),1),n("div",{class:"dropdown-item",onClick:t[1]||(t[1]=a=>{S(r.value),l.value=!1})},d(e.$t("delete")),1)]),_:1},8,["modelValue","anchor"])],64)}}});export{$e as _,ue as a};
