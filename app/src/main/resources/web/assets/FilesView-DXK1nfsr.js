import{_ as wo}from"./ListItemPhone.vuevuetypescriptsetuptruelang-Dd9W6-pF.js";import{_ as $o}from"./more-vert-Cihez65j.js";import{e as J,r as L,c as r,o,L as F,k as u,Z as O,M as re,K as I,G as Ve,z as k,q as p,ak as yt,ah as Pe,a as v,t as _,a8 as kt,by as Do,j as B,J as de,O as bt,bz as pe,l,aH as it,n as Q,R as lt,H as Y,S as at,d as Co,m as me,bA as It,bc as To,bB as Fo,$ as Se,f as wt,T as $t,w as Te,bC as qo,v as rt,y as So,bD as Vo,A as Po,B as ce,bE as Dt,bF as Eo,u as Bo,V as Lo,s as Fe,g as Uo,an as Ao,aT as dt,bG as Mo,bH as Oo,bI as Ro,aO as zo,W as Ho,bJ as Ko,am as ut,i as ct,aw as jo,X as No,Y as Go,p as Qo,ap as Jo,aq as Wo,br as Xo,a0 as Yo,a2 as ae,bK as pt,bL as Zo,F as G,bM as xo,bN as en,bO as tn,a5 as X,bP as mt,bQ as ft,aY as vt,bR as _t,at as qe,bS as ht,bT as on,a4 as nn,bU as sn,bV as ln}from"./index-CHzD12Eh.js";import{_ as Ct,a as an}from"./upload-rounded-CoC6T1sY.js";import{_ as rn}from"./FieldId.vuevuetypescriptsetuptruelang-zWKC_VfW.js";import{_ as Tt}from"./VCheckbox-DmONehvd.js";import{_ as dn,u as un,c as cn}from"./key-events-Cs6jhw6G.js";import{_ as pn,a as mn}from"./search-rounded-CsaI7Cic.js";import{_ as fn}from"./content-paste-rounded-CM_5IT0v.js";import{_ as vn}from"./DownloadMethodModal.vuevuetypescriptsetuptruelang-BaI12S2N.js";const _n={class:"actions"},hn={class:"card card-info"},gn={class:"key-value vertical"},yn={class:"key"},kn={class:"value"},bn=J({__name:"FileActionButtons",props:{item:{},canPaste:{type:Boolean}},emits:["downloadDir","downloadFile","uploadFiles","uploadDir","deleteItem","duplicateItem","cutItem","copyItem","pasteItem","copyLink","renameItem","addToFavorites"],setup(h,{emit:f}){const i=f,D=L(!1),y=L(!1),w=L(!1);function d(s){i("downloadDir",s)}function C(s){i("downloadFile",s)}function U(s){i("uploadFiles",s)}function A(s){i("uploadDir",s)}function $(s){i("deleteItem",s)}function g(s){i("duplicateItem",s)}function V(s){i("cutItem",s)}function H(s){i("copyItem",s)}function P(s){i("pasteItem",s)}function e(s){i("copyLink",s)}function a(s){i("renameItem",s)}function b(s){i("addToFavorites",s)}return(s,c)=>{const R=yt,q=Ve,m=Ct,K=Pe,Z=kt,W=Do,M=$o,z=re("tooltip");return o(),r("div",_n,[s.item.isDir?(o(),r(O,{key:0},[F((o(),I(q,{class:"sm",onClick:c[0]||(c[0]=k(S=>d(s.item.path),["stop"]))},{default:p(()=>[u(R)]),_:1})),[[z,s.$t("download")]]),u(K,{modelValue:D.value,"onUpdate:modelValue":c[3]||(c[3]=S=>D.value=S)},{trigger:p(()=>[F((o(),I(q,{class:"sm"},{default:p(()=>[u(m)]),_:1})),[[z,s.$t("upload")]])]),default:p(()=>[v("div",{class:"dropdown-item",onClick:c[1]||(c[1]=k(S=>{U(s.item.path),D.value=!1},["stop"]))},_(s.$t("upload_files")),1),v("div",{class:"dropdown-item",onClick:c[2]||(c[2]=k(S=>{A(s.item.path),D.value=!1},["stop"]))},_(s.$t("upload_folder")),1)]),_:1},8,["modelValue"])],64)):F((o(),I(q,{key:1,class:"sm",onClick:c[4]||(c[4]=k(S=>C(s.item.path),["stop"]))},{default:p(()=>[u(R)]),_:1})),[[z,s.$t("download")]]),F((o(),I(q,{class:"sm",onClick:c[5]||(c[5]=k(S=>$(s.item),["stop"]))},{default:p(()=>[u(Z)]),_:1})),[[z,s.$t("delete")]]),u(K,{modelValue:y.value,"onUpdate:modelValue":c[6]||(c[6]=S=>y.value=S)},{trigger:p(()=>[F((o(),I(q,{class:"sm"},{default:p(()=>[u(W)]),_:1})),[[z,s.$t("info")]])]),default:p(()=>[v("section",hn,[v("div",gn,[v("div",yn,_(s.$t("path")),1),v("div",kn,_(s.item.path),1)])])]),_:1},8,["modelValue"]),u(K,{modelValue:w.value,"onUpdate:modelValue":c[14]||(c[14]=S=>w.value=S)},{trigger:p(()=>[F((o(),I(q,{class:"sm"},{default:p(()=>[u(M)]),_:1})),[[z,s.$t("actions")]])]),default:p(()=>[v("div",{class:"dropdown-item",onClick:c[7]||(c[7]=k(S=>{g(s.item),w.value=!1},["stop"]))},_(s.$t("duplicate")),1),v("div",{class:"dropdown-item",onClick:c[8]||(c[8]=k(S=>{V(s.item),w.value=!1},["stop"]))},_(s.$t("cut")),1),v("div",{class:"dropdown-item",onClick:c[9]||(c[9]=k(S=>{H(s.item),w.value=!1},["stop"]))},_(s.$t("copy")),1),s.item.isDir&&s.canPaste?(o(),r("div",{key:0,class:"dropdown-item",onClick:c[10]||(c[10]=k(S=>{P(s.item),w.value=!1},["stop"]))},_(s.$t("paste")),1)):B("",!0),s.item.isDir?B("",!0):(o(),r("div",{key:1,class:"dropdown-item",onClick:c[11]||(c[11]=k(S=>{e(s.item),w.value=!1},["stop"]))},_(s.$t("copy_link")),1)),s.item.isDir?(o(),r("div",{key:2,class:"dropdown-item",onClick:c[12]||(c[12]=k(S=>{b(s.item),w.value=!1},["stop"]))},_(s.$t("add_to_favorites")),1)):B("",!0),v("div",{class:"dropdown-item",onClick:c[13]||(c[13]=k(S=>{a(s.item),w.value=!1},["stop"]))},_(s.$t("rename")),1)]),_:1},8,["modelValue"])])}}}),In=de(bn,[["__scopeId","data-v-c4ee8d44"]]),wn={class:"start"},$n={class:"number"},Dn={key:0,src:"/ficons/folder.svg",class:"svg"},Cn={key:0,class:"svg",src:pe},Tn=["src"],Fn=["src"],qn={key:3,class:"svg",src:pe},Sn={class:"title"},Vn={class:"subtitle"},Pn={key:0},En={key:1},Bn={key:0,src:"/ficons/folder.svg",class:"svg"},Ln={key:0,class:"svg",src:pe},Un=["src"],An=["src"],Mn={key:3,class:"svg",src:pe},On={key:0},Rn={key:1},zn=J({__name:"FileListItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},imageErrorIds:{},extensionImageErrorIds:{},canPaste:{type:Boolean},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function},onImageError:{type:Function},onExtensionImageError:{type:Function},viewItem:{type:Function},clickItem:{type:Function}},emits:["downloadDir","downloadFile","uploadFiles","uploadDir","deleteItem","duplicateItem","cutItem","copyItem","pasteItem","copyLink","renameItem","addToFavorites"],setup(h,{emit:f}){const i=f;function D(e){i("downloadDir",e)}function y(e){i("downloadFile",e)}function w(e){i("uploadFiles",e)}function d(e){i("uploadDir",e)}function C(e){i("deleteItem",e)}function U(e){i("duplicateItem",e)}function A(e){i("cutItem",e)}function $(e){i("copyItem",e)}function g(e){i("pasteItem",e)}function V(e){i("copyLink",e)}function H(e){i("renameItem",e)}function P(e){i("addToFavorites",e)}return(e,a)=>{const b=Tt,s=rn,c=In,R=wo,q=re("tooltip");return e.isPhone?(o(),I(R,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:a[10]||(a[10]=m=>e.handleItemClick(m,e.item,e.index,()=>e.clickItem(e.item))),onMouseenter:a[11]||(a[11]=k(m=>e.handleMouseOver(m,e.index),["stop"])),onCheckboxClick:a[12]||(a[12]=m=>e.toggleSelect(m,e.item,e.index))},{image:p(()=>[v("div",{class:"image",onClick:a[9]||(a[9]=m=>e.viewItem(m,e.item))},[e.item.isDir?(o(),r("img",Bn)):(o(),r(O,{key:1},[e.extensionImageErrorIds.includes(e.item.id)?(o(),r("img",Ln)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),r("img",{key:1,class:"image-thumb",src:l(it)(e.item.fileId,"&w=50&h=50"),onError:a[7]||(a[7]=m=>e.onImageError(e.item.id))},null,40,Un)):e.item.extension?(o(),r("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:a[8]||(a[8]=m=>e.onExtensionImageError(e.item.id))},null,40,An)):(o(),r("img",Mn))],64))])]),title:p(()=>[Y(_(e.item.name),1)]),subtitle:p(()=>[e.item.isDir?(o(),r("span",On,_(e.$t("x_items",e.item.children||0)),1)):(o(),r("span",Rn,_(l(Q)(e.item.size)),1)),F((o(),r("span",null,[Y(_(l(at)(e.item.updatedAt)),1)])),[[q,l(lt)(e.item.updatedAt)]])]),actions:p(()=>[u(c,{item:e.item,"can-paste":e.canPaste,onDownloadDir:D,onDownloadFile:y,onUploadFiles:w,onUploadDir:d,onDeleteItem:C,onDuplicateItem:U,onCutItem:A,onCopyItem:$,onPasteItem:g,onCopyLink:V,onRenameItem:H,onAddToFavorites:P},null,8,["item","can-paste"])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(o(),r("section",{key:0,class:bt(["file-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:a[5]||(a[5]=k(m=>e.handleItemClick(m,e.item,e.index,()=>e.clickItem(e.item)),["stop"])),onMouseenter:a[6]||(a[6]=k(m=>e.handleMouseOver(m,e.index),["stop"]))},[v("div",wn,[e.shiftEffectingIds.includes(e.item.id)?(o(),I(b,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:a[0]||(a[0]=k(m=>e.toggleSelect(m,e.item,e.index),["stop"]))},null,8,["checked"])):(o(),I(b,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:a[1]||(a[1]=k(m=>e.toggleSelect(m,e.item,e.index),["stop"]))},null,8,["checked"])),v("span",$n,[u(s,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),v("div",{class:"image",onClick:a[4]||(a[4]=m=>e.viewItem(m,e.item))},[e.item.isDir?(o(),r("img",Dn)):(o(),r(O,{key:1},[e.extensionImageErrorIds.includes(e.item.id)?(o(),r("img",Cn)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),r("img",{key:1,class:"image-thumb",src:l(it)(e.item.fileId,"&w=50&h=50"),onError:a[2]||(a[2]=m=>e.onImageError(e.item.id))},null,40,Tn)):e.item.extension?(o(),r("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:a[3]||(a[3]=m=>e.onExtensionImageError(e.item.id))},null,40,Fn)):(o(),r("img",qn))],64))]),v("div",Sn,_(e.item.name),1),v("div",Vn,[e.item.isDir?(o(),r("span",Pn,_(e.$t("x_items",e.item.children||0)),1)):(o(),r("span",En,_(l(Q)(e.item.size)),1)),F((o(),r("span",null,[Y(_(l(at)(e.item.updatedAt)),1)])),[[q,l(lt)(e.item.updatedAt)]])]),u(c,{item:e.item,"can-paste":e.canPaste,onDownloadDir:D,onDownloadFile:y,onUploadFiles:w,onUploadDir:d,onDeleteItem:C,onDuplicateItem:U,onCutItem:A,onCopyItem:$,onPasteItem:g,onCopyLink:V,onRenameItem:H,onAddToFavorites:P},null,8,["item","can-paste"])],34))}}}),Hn=de(zn,[["__scopeId","data-v-7d7965b5"]]),Kn={key:0,class:"file-item selectable-card-skeleton"},jn={class:"start"},Nn={class:"number"},Gn=J({__name:"FileSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(h){return(f,i)=>{const D=dn;return f.isPhone?(o(),I(D,{key:1,"title-width":"60%",subtitles:[{width:"45%"},{width:"40%"}],"action-count":5})):(o(),r("section",Kn,[v("div",jn,[i[0]||(i[0]=v("div",{class:"skeleton-checkbox"},null,-1)),v("span",Nn,_(f.index),1)]),i[1]||(i[1]=Co('<div class="image" data-v-037471a7><div class="skeleton-image lg" data-v-037471a7></div></div><div class="title" data-v-037471a7><div class="skeleton-text lg" style="width:40%;" data-v-037471a7></div></div><div class="subtitle" data-v-037471a7><div class="skeleton-text" style="width:30%;" data-v-037471a7></div></div><div class="actions" data-v-037471a7><div class="skeleton-text lg" style="width:240px;" data-v-037471a7></div></div>',4))]))}}}),Qn=de(Gn,[["__scopeId","data-v-037471a7"]]),Jn={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Wn(h,f){return o(),r("svg",Jn,f[0]||(f[0]=[v("path",{fill:"currentColor",d:"M19.075 21.9L17.5 20.35q-1.225.8-2.613 1.225T12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12q0-1.5.425-2.887T3.65 6.5L2.075 4.925q-.3-.3-.3-.712t.3-.713t.713-.3t.712.3l17 17q.3.3.3.7t-.3.7t-.712.3t-.713-.3M12 20q1.075 0 2.088-.275t1.962-.825L5.1 7.95q-.55.95-.825 1.962T4 12q0 3.325 2.338 5.663T12 20m0-16q-.825 0-1.612.163T8.85 4.65q-.4.175-.8.05t-.6-.475t-.088-.75t.488-.575q.975-.45 2.012-.675T12 2q2.075 0 3.9.788t3.175 2.137T21.213 8.1T22 12q0 1.1-.225 2.138T21.1 16.15q-.175.375-.575.488t-.75-.088t-.475-.6t.05-.8q.325-.75.488-1.537T20 12q0-3.325-2.337-5.663T12 4m-1.425 9.425"},null,-1)]))}const Xn=me({name:"material-symbols-hide-source-outline-rounded",render:Wn}),Ft=J({__name:"FileSearchFilters",props:{filter:{type:Object,required:!0}},emits:["filterChange"],setup(h,{emit:f}){const i=h,D=f;function y(){const d={...i.filter};d.text="",D("filterChange",d)}function w(){const d={...i.filter};d.showHidden=!1,D("filterChange",d)}return(d,C)=>{const U=pn,A=Xn,$=It;return h.filter.text||h.filter.showHidden?(o(),I($,{key:0},{default:p(()=>[h.filter.text?(o(),I(U,{key:"filter-text",label:h.filter.text,"remove-only":"",onRemove:y},null,8,["label"])):B("",!0),h.filter.showHidden?(o(),I(U,{key:"filter-show-hidden",label:d.$t("show_hidden"),"remove-only":"",onRemove:w},{default:p(()=>[u(A)]),_:1},8,["label"])):B("",!0)]),_:1})):B("",!0)}}}),Yn={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Zn(h,f){return o(),r("svg",Yn,f[0]||(f[0]=[v("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h5.175q.4 0 .763.15t.637.425L12 6h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6zm10-4v1q0 .425.288.713T15 16t.713-.288T16 15v-1h1q.425 0 .713-.288T18 13t-.288-.712T17 12h-1v-1q0-.425-.288-.712T15 10t-.712.288T14 11v1h-1q-.425 0-.712.288T12 13t.288.713T13 14z"},null,-1)]))}const xn=me({name:"material-symbols-create-new-folder-outline-rounded",render:Zn}),es=J({__name:"FilesKeyboardShortcuts",setup(h){const f=[{keys:["Delete"],description:"delete_selected"},{keys:["modifier","+","Backspace"],description:"delete_selected"},{keys:["modifier","+","A"],description:"select_all"},{keys:["Esc"],description:"clear_selection"},{keys:["Shift","+","Click"],description:"range_select"}];return(i,D)=>{const y=To;return o(),I(y,{shortcuts:f})}}}),ts=["onClick"],os=J({__name:"FilesActionButtons",props:{currentDir:{type:String,required:!0},canPaste:{type:Boolean,required:!0},pasting:{type:Boolean,required:!0},refreshing:{type:Boolean,required:!0},sorting:{type:Boolean,required:!0},sortItems:{type:Array,required:!0},fileSortBy:{type:String,required:!0}},emits:["createDir","uploadFiles","uploadDir","pasteDir","refreshCurrentDir","sort"],setup(h,{emit:f}){const i=f,D=L(!1),y=L(!1);function w(){i("createDir")}function d(g){i("uploadFiles",g)}function C(g){i("uploadDir",g)}function U(){i("pasteDir")}function A(){i("refreshCurrentDir")}function $(g){i("sort",g)}return(g,V)=>{const H=es,P=xn,e=Ve,a=Ct,b=Pe,s=fn,c=Fo,R=an,q=re("tooltip");return o(),r(O,null,[u(H),F((o(),I(e,{onClick:w},{default:p(()=>[u(P)]),_:1})),[[q,g.$t("create_folder")]]),u(b,{modelValue:D.value,"onUpdate:modelValue":V[2]||(V[2]=m=>D.value=m)},{trigger:p(()=>[F((o(),I(e,null,{default:p(()=>[u(a)]),_:1})),[[q,g.$t("upload")]])]),default:p(()=>[v("div",{class:"dropdown-item",onClick:V[0]||(V[0]=k(m=>{d(h.currentDir),D.value=!1},["stop"]))},_(g.$t("upload_files")),1),v("div",{class:"dropdown-item",onClick:V[1]||(V[1]=k(m=>{C(h.currentDir),D.value=!1},["stop"]))},_(g.$t("upload_folder")),1)]),_:1},8,["modelValue"]),h.canPaste?F((o(),I(e,{key:0,loading:h.pasting,onClick:U},{default:p(()=>[u(s)]),_:1},8,["loading"])),[[q,g.$t("paste")]]):B("",!0),F((o(),I(e,{loading:h.refreshing,onClick:A},{default:p(()=>[u(c)]),_:1},8,["loading"])),[[q,g.$t("refresh")]]),u(b,{modelValue:y.value,"onUpdate:modelValue":V[3]||(V[3]=m=>y.value=m)},{trigger:p(()=>[F((o(),I(e,{loading:h.sorting},{default:p(()=>[u(R)]),_:1},8,["loading"])),[[q,g.$t("sort")]])]),default:p(()=>[(o(!0),r(O,null,Se(h.sortItems,m=>(o(),r("div",{key:m.value,class:bt(["dropdown-item",{selected:m.value===h.fileSortBy}]),onClick:K=>{$(m.value),y.value=!1}},_(g.$t(m.label)),11,ts))),128))]),_:1},8,["modelValue"])],64)}}}),ns={class:"btn-icon"},ss={class:"filters"},is={class:"form-row"},ls={class:"buttons"},as={class:"form-label"},rs=J({__name:"FileSearchInput",props:{parent:{type:String,required:!0},filter:{type:Object,required:!0},getUrl:{type:Function,required:!0},navigateToDir:{type:Function,required:!1,default:()=>{}},showChips:{type:Boolean,default:!0},isPhone:{type:Boolean,default:!1}},setup(h,{expose:f}){const{buildQ:i}=Dt(),D=wt(),y=h,w=L(!1),d=L(!1),C=$t({showHidden:!1,type:"",rootPath:"",text:"",parent:""});Te(y.filter,a=>{Object.assign(C,a)},{immediate:!0,deep:!0}),Te(w,a=>{a&&Object.assign(C,y.filter)}),Te(d,a=>{a&&Object.assign(C,y.filter)});function U(a){return a.startsWith("/")}function A(){var b;const a=(b=C.text)==null?void 0:b.trim();if(a&&U(a)&&y.navigateToDir){y.navigateToDir(a),w.value=!1;return}V(),w.value=!1}function $(){d.value=!0}function g(){var b;const a=(b=C.text)==null?void 0:b.trim();if(a&&U(a)&&y.navigateToDir){y.navigateToDir(a),d.value=!1;return}V(),d.value=!1}function V(){Object.assign(y.filter,C),H(y.filter)}function H(a){ce(D,y.getUrl(i(a)))}function P(){C.showHidden=!C.showHidden}function e(a){Object.assign(y.filter,a),ce(D,y.getUrl(i(y.filter)))}return f({dismiss:()=>{w.value=!1,d.value=!1}}),(a,b)=>{const s=mn,c=So,R=Vo,q=It,m=Po,K=Pe,Z=qo,W=re("tooltip");return o(),r(O,null,[h.showChips?(o(),I(Ft,{key:0,filter:h.filter,onFilterChange:e},null,8,["filter"])):B("",!0),h.isPhone?B("",!0):(o(),I(K,{key:1,modelValue:w.value,"onUpdate:modelValue":b[1]||(b[1]=M=>w.value=M),"max-height":400},{trigger:p(()=>[F((o(),r("button",ns,[u(s)])),[[W,a.$t("search")]])]),default:p(()=>[v("div",ss,[v("div",is,[u(c,{modelValue:C.text,"onUpdate:modelValue":b[0]||(b[0]=M=>C.text=M),label:a.$t("keywords"),onKeyup:rt(A,["enter"])},null,8,["modelValue","label"])]),u(q,null,{default:p(()=>[u(R,{key:"chip-show-hidden",label:a.$t("show_hidden"),selected:C.showHidden,onClick:P},null,8,["label","selected"])]),_:1}),v("div",ls,[u(m,{onClick:k(A,["stop"])},{default:p(()=>[Y(_(a.$t("search")),1)]),_:1})])])]),_:1},8,["modelValue"])),h.isPhone?F((o(),r("button",{key:2,class:"btn-icon mobile-search-btn",onClick:$},[u(s)])),[[W,a.$t("search")]]):B("",!0),h.isPhone?(o(),I(Z,{key:3,modelValue:d.value,"onUpdate:modelValue":b[3]||(b[3]=M=>d.value=M),title:a.$t("search"),"show-footer":""},{footer:p(()=>[u(m,{class:"search-apply-btn",onClick:g},{default:p(()=>[Y(_(a.$t("search")),1)]),_:1})]),default:p(()=>[v("label",as,_(a.$t("keywords")),1),u(c,{modelValue:C.text,"onUpdate:modelValue":b[2]||(b[2]=M=>C.text=M),onKeyup:rt(g,["enter"])},null,8,["modelValue"]),u(q,{style:{"margin-block-start":"16px"}},{default:p(()=>[u(R,{label:a.$t("show_hidden"),selected:C.showHidden,onClick:P},null,8,["label","selected"])]),_:1})]),_:1},8,["modelValue","title"])):B("",!0)],64)}}}),ds=de(rs,[["__scopeId","data-v-74f5c5d2"]]),us={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function cs(h,f){return o(),r("svg",us,f[0]||(f[0]=[v("path",{fill:"currentColor",d:"m12 14l-2.35 2.35q.2.375.275.8T10 18q0 1.65-1.175 2.825T6 22t-2.825-1.175T2 18t1.175-2.825T6 14q.425 0 .85.075t.8.275L10 12L7.65 9.65q-.375.2-.8.275T6 10q-1.65 0-2.825-1.175T2 6t1.175-2.825T6 2t2.825 1.175T10 6q0 .425-.075.85t-.275.8L20.6 18.6q.675.675.3 1.538T19.575 21q-.275 0-.537-.112t-.463-.313zm3-3l-2-2l5.575-5.575q.2-.2.463-.312T19.574 3q.95 0 1.313.875t-.313 1.55zM6 8q.825 0 1.413-.587T8 6t-.587-1.412T6 4t-1.412.588T4 6t.588 1.413T6 8m6 4.5q.2 0 .35-.15t.15-.35t-.15-.35t-.35-.15t-.35.15t-.15.35t.15.35t.35.15M6 20q.825 0 1.413-.587T8 18t-.587-1.412T6 16t-1.412.588T4 18t.588 1.413T6 20"},null,-1)]))}const ps=me({name:"material-symbols-content-cut-rounded",render:cs}),ms={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function fs(h,f){return o(),r("svg",ms,f[0]||(f[0]=[v("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm0-2h9V4H9zm-4 6q-.825 0-1.412-.587T3 20V7q0-.425.288-.712T4 6t.713.288T5 7v13h10q.425 0 .713.288T16 21t-.288.713T15 22zm4-6V4z"},null,-1)]))}const vs=me({name:"material-symbols-content-copy-outline-rounded",render:fs}),_s=Eo("files",{state:()=>({selectedFiles:[],isCut:!1})}),hs={class:"top-app-bar"},gs={class:"title"},ys={key:0},ks={key:1,class:"breadcrumb"},bs={key:0},Is=["onClick"],ws={key:0},$s=["onClick"],Ds={key:0,class:"actions"},Cs={key:0,class:"secondary-actions"},Ts={key:2,class:"scroller-wrapper"},Fs={class:"scroller main-list"},qs={key:1,class:"no-data-placeholder"},gt=1e4,Ss=J({__name:"FilesView",setup(h){var ot;const f=Qo("isPhone"),{t:i}=Bo(),D=L([]),{parseQ:y,buildQ:w}=Dt(),d=$t({type:"",rootPath:"",showHidden:!1,text:"",parent:""}),U=Lo().query,A=L(""),$=L([]),{selectedIds:g,allChecked:V,realAllChecked:H,clearSelection:P,toggleAllChecked:e,toggleSelect:a,total:b,checked:s,shiftEffectingIds:c,handleItemClick:R,handleMouseOver:q,selectAll:m,shouldSelect:K}=un($),{keyDown:Z,keyUp:W}=cn(m,P,()=>{Ge()}),M=L(!1),z=L(!1),S=L([]),Ee=L([]),qt=t=>{S.value.push(t)},St=t=>{Ee.value.push(t)},Be=Jo(),fe=wt(),{fileSortBy:se}=Fe(fe),Le=Uo(),{app:ve,urlTokenKey:j,uploads:_e}=Fe(Le),{selectedFiles:Vt,isCut:Pt}=Fe(_s()),{dropping:Et,fileDragEnter:Ue,fileDragLeave:Ae,dropFiles:Bt}=Ao(_e),x=dt(()=>d.rootPath),{createPath:Lt,createVariables:Ut,createMutation:At}=Mo(j,$),{renameItem:Mt,renameDone:Ot,renameMutation:Rt,renameVariables:zt}=Oo(()=>{ee()}),{internal:Me,sdcard:Oe,usb:Ht,refetch:he}=Ro(),{downloadFile:ie,downloadDir:ge,downloadFiles:Kt}=jo(j),{view:Re}=on(D,(t,n)=>{Le.lightbox={sources:t,index:n,visible:!0}}),jt=L(parseInt(((ot=U.page)==null?void 0:ot.toString())??"1")),Nt=dt(()=>{const t=[];let n=d.parent;for(;n&&n!==x.value;)t.unshift({path:n,name:zo(n)}),n=n.substring(0,n.lastIndexOf("/"));return t.unshift({path:x.value,name:eo()}),t}),ze=L(!0),{loading:ye,fetch:ee}=Ho({handle:async(t,n)=>{if(ze.value=!1,M.value=!1,z.value=!1,n)G(i(n),"error");else{const E=[];for(const te of t.files)E.push(xo(te,j.value));$.value=E,b.value=E.length}},document:Zo,variables:()=>({root:x.value,offset:(jt.value-1)*gt,limit:gt,query:A.value,sortBy:se.value}),options:{fetchPolicy:"cache-and-network"}}),{loading:He,canPaste:ke,copy:be,cut:Ke,paste:Ie}=Ko($,Pt,Vt,ee,he),{input:Gt,upload:Qt,uploadChanged:je}=ut(_e),{input:Jt,upload:Wt,uploadChanged:Ne}=ut(_e),{loading:Xt,mutate:Yt,onDone:Zt}=ct({document:en});Zt(t=>{Kt(t.data.setTempValue.key),P()});const xt=()=>{const t=$.value.filter(n=>g.value.includes(n.id));if(t.length===0){G(i("select_first"),"error");return}if(t.length===1){const n=t[0];n.isDir?ge(n.path):ie(n.path),P();return}ae(vn,{onEach:async()=>{for(const n of t)n.isDir?ge(n.path):ie(n.path),await new Promise(E=>setTimeout(E,250));P()},onZip:()=>{Yt({key:ln(),value:JSON.stringify(g.value.map(n=>({path:n})))})}})},we=t=>{t.forEach(n=>{sn($.value,E=>E.id===n.id)}),b.value=$.value.length,P(),he()},Ge=()=>{ae(mt,{files:$.value.filter(t=>g.value.includes(t.id)),onDone:t=>{we(t)}})};function eo(){if(d.type==="SDCARD")return i("sdcard");if(d.type==="APP")return i("app_data");if(d.type==="USB_STORAGE"){const t=ve.value.usbDiskPaths.indexOf(d.rootPath),n=t!==-1?t+1:1;return`${i("usb_storage")} ${n}`}return i("internal_storage")}function Qe(){var t,n,E,te;if(d.type==="SDCARD")return`${i("storage_free_total",{free:Q(((t=Oe.value)==null?void 0:t.freeBytes)??0),total:Q(((n=Oe.value)==null?void 0:n.totalBytes)??0)})}`;if(d.type==="APP")return i("app_data");if(d.type==="USB_STORAGE"){const oe=ve.value.usbDiskPaths.indexOf(d.rootPath),N=Ht.value[oe];return`${i("storage_free_total",{free:Q((N==null?void 0:N.freeBytes)??0),total:Q((N==null?void 0:N.totalBytes)??0)})}`}return`${Q(((E=Me.value)==null?void 0:E.freeBytes)??0)} / ${Q(((te=Me.value)==null?void 0:te.totalBytes)??0,!0,0)}`}function le(t){P(),d.parent=t,d.text="";const n=w(d);ce(fe,ue(n))}function ue(t){return t?`/files?q=${t}`:"/files"}function to(t){if(t.isDir){le(t.path);return}if(ft(t.name)){const n=vt(j.value,t.path);window.open(`/text-file?id=${encodeURIComponent(n)}`,"_blank")}else _t(t.name)?window.open(qe(j.value,t.path),"_blank"):ht(t.name)?Re($.value,t):ie(t.path)}function oo(t,n){if(!n.isDir)if(t.stopPropagation(),ft(n.name)){const E=vt(j.value,n.path);window.open(`/text-file?id=${encodeURIComponent(E)}`,"_blank")}else _t(n.name)?window.open(qe(j.value,n.path),"_blank"):ht(n.name)?Re($.value,n):ie(n.path)}function Je(t){se.value!==t&&(z.value=!0,se.value=t)}function We(){M.value=!0,ee()}const Xe=()=>{Lt.value=d.parent,ae(pt,{title:i("create_folder"),placeholder:i("name"),mutation:At,getVariables:Ut})};function $e(t){Qt(t)}function De(t){Wt(t)}function no(){be(g.value),P()}function so(){Ke(g.value),P()}function Ye(){Ie(d.parent)}function io(t){be([t.id]),Ie(d.parent)}function lo(t){Ke([t.id])}function ao(t){be([t.id])}function ro(t){const n=qe(j.value,t.path);navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(n).then(()=>{G(i("link_copied"))}).catch(()=>{Ze(n)}):Ze(n)}function Ze(t){try{const n=document.createElement("textarea");n.value=t,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select();const E=document.execCommand("copy");document.body.removeChild(n),E?G(i("link_copied")):G(i("copy_failed"),"error")}catch(n){console.error("Failed to copy text: ",n),G(i("copy_failed"),"error")}}function uo(t){Ie(t.path)}function co(t){Mt.value=t,ae(pt,{title:i("rename"),placeholder:i("name"),value:t.name,mutation:Rt,getVariables:zt,done:Ot})}function po(t){ae(mt,{files:[t],onDone:we})}const{mutate:mo,loading:Vs}=ct({document:tn,options:{update:()=>{X.emit("refetch_app")}}});function fo(t){if(!t.isDir)return;let n=x.value;mo({rootPath:n,fullPath:t.path}).then(()=>{G(i("added"))}).catch(E=>{console.error("Error adding favorite folder:",E),G(i("error"),"error")})}function vo(t){Object.assign(d,t);const n=w(d);ce(fe,ue(n))}const xe=t=>{t.status==="done"&&setTimeout(()=>{ee(),he()},1e3)},et=t=>{we([t.item])},tt=t=>{ee()};function _o(t){Bt(t,d.parent,()=>!0)}return No(()=>{var t;A.value=nn(((t=U.q)==null?void 0:t.toString())??""),y(d,A.value),ee(),X.on("upload_task_done",xe),X.on("file_deleted",et),X.on("file_renamed",tt),window.addEventListener("keydown",Z),window.addEventListener("keyup",W)}),Go(()=>{X.off("upload_task_done",xe),X.off("file_deleted",et),X.off("file_renamed",tt),window.removeEventListener("keydown",Z),window.removeEventListener("keyup",W)}),(t,n)=>{const E=Tt,te=vs,oe=Ve,N=ps,ho=kt,go=yt,nt=ds,st=os,yo=Ft,ko=Qn,bo=Hn,ne=re("tooltip");return o(),r(O,null,[v("div",hs,[u(E,{"touch-target":"wrapper",checked:l(V),indeterminate:!l(V)&&l(s),onChange:l(e)},null,8,["checked","indeterminate","onChange"]),v("div",gs,[l(g).length?(o(),r("span",ys,_(t.$t("x_selected",{count:l(H)?l(b).toLocaleString():l(g).length.toLocaleString()})),1)):(o(),r("div",ks,[(o(!0),r(O,null,Se(Nt.value,(T,Ce)=>(o(),r(O,{key:T.path},[Ce===0?(o(),r(O,{key:0},[T.path===d.parent?F((o(),r("span",bs,[Y(_(T.name)+" ("+_(l(b))+")",1)])),[[ne,Qe()]]):F((o(),r("a",{key:1,href:"#",onClick:k(Io=>le(T.path),["stop","prevent"])},[Y(_(T.name),1)],8,Is)),[[ne,Qe()]])],64)):(o(),r(O,{key:1},[T.path===d.parent?(o(),r("span",ws,_(T.name)+" ("+_(l(b))+")",1)):(o(),r("a",{key:1,href:"#",onClick:k(Io=>le(T.path),["stop","prevent"])},_(T.name),9,$s))],64))],64))),128))])),l(s)?(o(),r(O,{key:2},[F((o(),I(oe,{onClick:k(no,["stop"])},{default:p(()=>[u(te)]),_:1})),[[ne,t.$t("copy")]]),F((o(),I(oe,{onClick:k(so,["stop"])},{default:p(()=>[u(N)]),_:1})),[[ne,t.$t("cut")]]),F((o(),I(oe,{onClick:k(Ge,["stop"])},{default:p(()=>[u(ho)]),_:1})),[[ne,t.$t("delete")]]),F((o(),I(oe,{loading:l(Xt),onClick:k(xt,["stop"])},{default:p(()=>[u(go)]),_:1},8,["loading"])),[[ne,t.$t("download")]])],64)):B("",!0)]),!l(f)&&!l(s)?(o(),r("div",Ds,[u(nt,{filter:d,parent:x.value,"get-url":ue,"navigate-to-dir":le,"show-chips":!l(f),"is-phone":l(f)},null,8,["filter","parent","show-chips","is-phone"]),u(st,{"current-dir":d.parent,"can-paste":l(ke)(),pasting:l(He),refreshing:M.value,sorting:z.value,"sort-items":l(Be),"file-sort-by":l(se),onCreateDir:Xe,onUploadFiles:$e,onUploadDir:De,onPasteDir:Ye,onRefreshCurrentDir:We,onSort:Je},null,8,["current-dir","can-paste","pasting","refreshing","sorting","sort-items","file-sort-by"])])):B("",!0)]),l(f)&&!l(s)?(o(),r("div",Cs,[u(nt,{filter:d,parent:x.value,"get-url":ue,"navigate-to-dir":le,"show-chips":!l(f),"is-phone":l(f)},null,8,["filter","parent","show-chips","is-phone"]),u(st,{"current-dir":d.parent,"can-paste":l(ke)(),pasting:l(He),refreshing:M.value,sorting:z.value,"sort-items":l(Be),"file-sort-by":l(se),onCreateDir:Xe,onUploadFiles:$e,onUploadDir:De,onPasteDir:Ye,onRefreshCurrentDir:We,onSort:Je},null,8,["current-dir","can-paste","pasting","refreshing","sorting","sort-items","file-sort-by"])])):B("",!0),l(f)?(o(),I(yo,{key:1,class:"mobile-search-filters",filter:d,onFilterChange:vo},null,8,["filter"])):B("",!0),l(ye)&&ze.value?(o(),r("div",Ts,[v("div",Fs,[(o(),r(O,null,Se(20,T=>u(ko,{key:T,index:T,"is-phone":l(f)},null,8,["index","is-phone"])),64))])])):B("",!0),v("div",{class:"scroller-wrapper",onDragover:n[3]||(n[3]=k((...T)=>l(Ue)&&l(Ue)(...T),["stop","prevent"]))},[F(v("div",{class:"drag-mask",onDrop:k(_o,["stop","prevent"]),onDragleave:n[0]||(n[0]=k((...T)=>l(Ae)&&l(Ae)(...T),["stop","prevent"]))},_(t.$t("release_to_send_files")),545),[[Wo,l(Et)]]),$.value.length>0?(o(),I(l(Xo),{key:0,class:"scroller main-list","data-key":"id","data-sources":$.value,"estimate-size":80},{item:p(({index:T,item:Ce})=>[u(bo,{item:Ce,index:T,"selected-ids":l(g),"shift-effecting-ids":l(c),"should-select":l(K),"is-phone":l(f),"image-error-ids":S.value,"extension-image-error-ids":Ee.value,"can-paste":l(ke)(),"handle-item-click":l(R),"handle-mouse-over":l(q),"toggle-select":l(a),"on-image-error":qt,"on-extension-image-error":St,"view-item":oo,"click-item":to,onDownloadDir:l(ge),onDownloadFile:l(ie),onUploadFiles:$e,onUploadDir:De,onDeleteItem:po,onDuplicateItem:io,onCutItem:lo,onCopyItem:ao,onPasteItem:uo,onCopyLink:ro,onRenameItem:co,onAddToFavorites:fo},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","image-error-ids","extension-image-error-ids","can-paste","handle-item-click","handle-mouse-over","toggle-select","onDownloadDir","onDownloadFile"])]),_:1},8,["data-sources"])):B("",!0),!l(ye)&&$.value.length===0?(o(),r("div",qs,_(t.$t(l(Yo)(l(ye),l(ve).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):B("",!0),v("input",{ref_key:"fileInput",ref:Gt,style:{display:"none"},type:"file",multiple:"",onChange:n[1]||(n[1]=(...T)=>l(je)&&l(je)(...T))},null,544),v("input",{ref_key:"dirFileInput",ref:Jt,style:{display:"none"},type:"file",multiple:"",webkitdirectory:"",mozdirectory:"",directory:"",onChange:n[2]||(n[2]=(...T)=>l(Ne)&&l(Ne)(...T))},null,544)],32)],64)}}}),Hs=de(Ss,[["__scopeId","data-v-3e995faf"]]);export{Hs as default};
