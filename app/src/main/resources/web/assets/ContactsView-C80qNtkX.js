import{_ as at}from"./VPagination.vuevuetypescriptsetuptruelang-B7Sa-dGQ.js";import{_ as it,b as dt,u as ut,a as rt}from"./key-events-DeJMQ3Gp.js";import{d as ee,c as s,M as V,o as l,a as c,N as ct,t as i,m as re,aD as Me,r as P,aE as Ae,aF as Ee,aG as W,ai as mt,aH as pt,x as g,j as r,an as ye,k as n,J as D,C as De,A as Fe,y as _t,z as vt,aI as ze,W as Be,u as Pe,i as ve,aJ as Te,af as fe,h as U,a0 as $,a1 as w,ac as ge,al as ft,aK as yt,O,P as be,I as he,B as F,Q as Oe,R as Re,aL as Ne,T as gt,U as Ie,V as qe,aM as ue,L as Ke,e as bt,s as ht,f as $t,X as kt,Y as Ct,g as wt,w as Vt,Z as Tt,$ as Nt,a2 as It,a5 as de,aN as qt,H as Le,aO as Lt,K as St,ao as Ut,v as Mt,a4 as At,D as Et,a6 as Dt,ag as Ft,a7 as Y,a8 as zt,a9 as Bt,aP as Pt}from"./index-DK2k7uUz.js";import{_ as Ot}from"./AllCheckedAlert.vuevuetypescriptsetuptruelang-BaeCK0x8.js";import{_ as Qe}from"./VCheckbox-ChdySfCx.js";import{_ as Rt}from"./VSelect-CbzUQrqX.js";import{u as Kt,a as Qt}from"./tags-DGia9o9R.js";import{_ as jt}from"./ListItemPhone.vuevuetypescriptsetuptruelang-QRqCHaZt.js";import{_ as Ht}from"./call-outline-rounded-D-ziTXzp.js";import{_ as Gt}from"./FieldId.vuevuetypescriptsetuptruelang-BCKfQAtO.js";const Jt={key:0,class:"contact-item selectable-card-skeleton"},Wt={class:"start"},Xt={class:"number"},Yt=ee({__name:"ContactSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(q){return(y,f)=>{const a=it;return y.isPhone?(l(),V(a,{key:1,"title-width":"70%",subtitles:[{width:"45%"},{width:"30%"},{width:"40%"}],"action-count":3})):(l(),s("section",Jt,[c("div",Wt,[f[0]||(f[0]=c("div",{class:"skeleton-checkbox"},null,-1)),c("span",Xt,i(y.index),1)]),f[1]||(f[1]=ct('<div class="image"><div class="skeleton-image lg"></div></div><div class="title"><div class="skeleton-text lg" style="width:50%;"></div></div><div class="subtitle"><div class="skeleton-text" style="width:40%;"></div></div><div class="info"><div class="skeleton-text" style="width:180px;"></div></div><div class="actions"><div class="skeleton-text lg" style="width:120px;"></div></div><div class="time"><div class="skeleton-text" style="width:60px;"></div></div>',6))]))}}}),Zt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function xt(q,y){return l(),s("svg",Zt,y[0]||(y[0]=[c("path",{fill:"currentColor",d:"M12 13.825L8.1 17.7q-.275.275-.687.288T6.7 17.7q-.275-.275-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.213t.375-.062t.375.062t.325.213l4.6 4.6q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275zm0-6L8.1 11.7q-.275.275-.687.288T6.7 11.7q-.275-.275-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.212T12 5.425t.375.063t.325.212l4.6 4.6q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275z"},null,-1)]))}const el=re({name:"material-symbols-keyboard-double-arrow-up-rounded",render:xt}),tl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ll(q,y){return l(),s("svg",tl,y[0]||(y[0]=[c("path",{fill:"currentColor",d:"m12 16.175l3.9-3.875q.275-.275.688-.288t.712.288q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213l-4.6-4.6q-.275-.275-.288-.687T6.7 12.3q.275-.275.7-.275t.7.275zm0-6L15.9 6.3q.275-.275.688-.287t.712.287q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213L6.7 7.7q-.275-.275-.288-.687T6.7 6.3q.275-.275.7-.275t.7.275z"},null,-1)]))}const ol=re({name:"material-symbols-keyboard-double-arrow-down-rounded",render:ll});function Z(q){return Array.from({length:q},(y,f)=>f+1).concat(-1)}const oe={phoneNumberTypes:Z(20),emailTypes:Z(4),addressTypes:Z(3),eventTypes:Z(3),imTypes:Z(8),websiteTypes:Z(7)},nl=ee({__name:"PromptModal",props:{do:{type:Function,required:!0},title:{type:String,required:!0},value:{type:String,default:""}},setup(q){const{handleSubmit:y}=Me(),f=P(),a=q,{value:h,resetField:M,errorMessage:L}=Ae("inputValue",Ee().required()),A=y(()=>{a.do(String(h.value||"")),W()});return a.value?h.value=a.value:M(),mt(async()=>{await pt(),requestAnimationFrame(()=>{setTimeout(()=>{var e;try{document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),(e=f.value)==null||e.focus()}catch(_){console.debug("Focus blocked:",_)}},100)})}),(e,_)=>{const k=Fe,S=ye,N=De,E=ze;return l(),V(E,{onClose:n(W)},{headline:g(()=>[D(i(q.title),1)]),content:g(()=>[r(k,{ref_key:"inputRef",ref:f,modelValue:n(h),"onUpdate:modelValue":_[0]||(_[0]=K=>vt(h)?h.value=K:null),class:"form-control",error:!!n(L),"error-text":n(L)?e.$t(n(L)):"",onKeyup:_t(n(A),["enter"])},null,8,["modelValue","error","error-text","onKeyup"])]),actions:g(()=>[r(S,{value:"cancel",onClick:n(W)},{default:g(()=>[D(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),r(N,{value:"ok",onClick:n(A)},{default:g(()=>[D(i(e.$t("ok")),1)]),_:1},8,["onClick"])]),_:1},8,["onClose"])}}}),sl={class:"form-label"},al={class:"form-row"},il={key:1,class:"v-center"},dl={key:0,class:"form-row"},ul={class:"v-center"},rl={class:"form-label"},cl={class:"v-center"},ml=["onClick"],pl={key:1,class:"form-label"},_l={class:"v-center"},vl=["onClick"],fl={key:2,class:"form-label"},yl={class:"v-center"},gl=["onClick"],bl={key:3,class:"form-label"},hl={class:"v-center"},$l=["onClick"],kl={key:4,class:"form-label"},Cl={class:"v-center"},wl=["onClick"],Vl={class:"form-row",style:{display:"block",position:"relative"}},Tl={class:"form-row"},Se=ee({__name:"EditContactModal",props:{data:{type:Object,default:()=>({})},sources:{type:Array,default:()=>[]},done:{type:Function,default:()=>{}}},setup(q){const{handleSubmit:y}=Me(),f=q,a=Be({firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",nickname:"",organization:null,notes:"",source:"",starred:0,phoneNumbers:[],emails:[],addresses:[],websites:[],events:[],ims:[],groupIds:[]}),h=P(!1),M=P(!1),{t:L}=Pe(),{mutate:A,loading:e,onDone:_}=ve({document:fe`
    mutation createContact($input: ContactInput!) {
      createContact(input: $input) {
        ...ContactFragment
      }
    }
    ${Te}
  `,options:{update:()=>{f.done()}}}),{mutate:k,loading:S,onDone:N}=ve({document:fe`
    mutation updateContact($id: ID!, $input: ContactInput!) {
      updateContact(id: $id, input: $input) {
        ...ContactFragment
      }
    }
    ${Te}
  `,options:{update:()=>{f.done()}}}),{value:E,resetField:K,errorMessage:te}=Ae("inputValue",Ee().test("required",o=>"valid.required",o=>!0).test("target-value",o=>"invalid_value",o=>!0)),z=(o,m)=>{o.splice(0,o.length);for(const v of m)o.push({label:v.label,value:v.value,type:v.type})};(()=>{const o=f.data;o?(Object.assign(a,{firstName:o.firstName,middleName:o.middleName,lastName:o.lastName,prefix:o.prefix,suffix:o.suffix,notes:o.notes}),z(a.phoneNumbers,o.phoneNumbers),z(a.emails,o.emails),z(a.addresses,o.addresses),z(a.websites,o.websites),z(a.events,o.events),z(a.ims,o.ims)):(Object.assign(a,{firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",notes:"",phoneNumbers:[{type:2,value:"",label:""}],emails:[],addresses:[],websites:[],events:[],ims:[]}),K())})();const I=o=>{o.type===-1&&yt(nl,{value:o.label,title:L("custom"),do:m=>{o.label=m}})},t=(o,m,v)=>m===-1?o.label?o.label:L("custom"):L(`contact.${v}.${m}`),C=(o,m,v)=>o.map(Q=>({value:Q,label:t(v,Q,m)})),R=o=>{o.push({type:1,value:"",label:""}),M.value=!1},j=(o,m)=>{o.splice(m,1)},X=y(()=>{var o,m;f.data?k({id:f.data.id,input:a}):(a.source=((m=(o=f.sources)==null?void 0:o[0])==null?void 0:m.name)??"",A({input:a}))});return _(()=>{W()}),N(()=>{W()}),(o,m)=>{const v=Fe,Q=ol,ce=el,H=Rt,G=ge,ne=ye,me=ft,se=De,ae=ze;return l(),V(ae,{onClose:n(W)},{headline:g(()=>[D(i(q.data?o.$t("edit"):o.$t("create")),1)]),content:g(()=>[c("label",sl,i(o.$t("name")),1),c("div",al,[r(v,{modelValue:a.firstName,"onUpdate:modelValue":m[0]||(m[0]=d=>a.firstName=d),label:o.$t("first_name")},null,8,["modelValue","label"]),h.value?(l(),V(v,{key:0,modelValue:a.middleName,"onUpdate:modelValue":m[1]||(m[1]=d=>a.middleName=d),label:o.$t("middle_name")},null,8,["modelValue","label"])):U("",!0),r(v,{modelValue:a.lastName,"onUpdate:modelValue":m[2]||(m[2]=d=>a.lastName=d),label:o.$t("last_name")},null,8,["modelValue","label"]),h.value?U("",!0):(l(),s("div",il,[c("button",{class:"btn-icon",onClick:m[3]||(m[3]=d=>h.value=!0)},[r(Q)])]))]),h.value?(l(),s("div",dl,[r(v,{modelValue:a.prefix,"onUpdate:modelValue":m[4]||(m[4]=d=>a.prefix=d),label:o.$t("prefix")},null,8,["modelValue","label"]),r(v,{modelValue:a.suffix,"onUpdate:modelValue":m[5]||(m[5]=d=>a.suffix=d),label:o.$t("suffix")},null,8,["modelValue","label"]),c("div",ul,[c("button",{class:"btn-icon",onClick:m[6]||(m[6]=d=>h.value=!1)},[r(ce)])])])):U("",!0),c("label",rl,i(o.$t("phone_number")),1),(l(!0),s($,null,w(a.phoneNumbers,(d,T)=>(l(),s("div",{key:T,class:"form-row"},[r(H,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:C(n(oe).phoneNumberTypes,"phone_number_type",d),onChange:p=>I(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,placeholder:o.$t("telephone"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),c("div",cl,[a.phoneNumbers.length>1?(l(),s("button",{key:0,class:"btn-icon",onClick:p=>j(a.phoneNumbers,T)},[r(G)],8,ml)):U("",!0)])]))),128)),a.emails.length?(l(),s("label",pl,i(o.$t("email")),1)):U("",!0),(l(!0),s($,null,w(a.emails,(d,T)=>(l(),s("div",{key:T,class:"form-row"},[r(H,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:C(n(oe).emailTypes,"email_type",d),onChange:p=>I(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,label:o.$t("email"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","label"]),c("div",_l,[c("button",{class:"btn-icon",onClick:p=>j(a.emails,T)},[r(G)],8,vl)])]))),128)),a.addresses.length?(l(),s("label",fl,i(o.$t("address")),1)):U("",!0),(l(!0),s($,null,w(a.addresses,(d,T)=>(l(),s("div",{key:T,class:"form-row"},[r(H,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:C(n(oe).addressTypes,"address_type",d),onChange:p=>I(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,label:o.$t("address"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","label"]),c("div",yl,[c("button",{class:"btn-icon",onClick:p=>j(a.addresses,T)},[r(G)],8,gl)])]))),128)),a.websites.length?(l(),s("label",bl,i(o.$t("website")),1)):U("",!0),(l(!0),s($,null,w(a.websites,(d,T)=>(l(),s("div",{key:T,class:"form-row"},[r(H,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:C(n(oe).websiteTypes,"website_type",d),onChange:p=>I(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,placeholder:o.$t("website"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),c("div",hl,[c("button",{class:"btn-icon",onClick:p=>j(a.websites,T)},[r(G)],8,$l)])]))),128)),a.ims.length?(l(),s("label",kl,i(o.$t("im")),1)):U("",!0),(l(!0),s($,null,w(a.ims,(d,T)=>(l(),s("div",{key:T,class:"form-row"},[r(H,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:C(n(oe).imTypes,"im_type",d),onChange:p=>I(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,placeholder:o.$t("im"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),c("div",Cl,[c("button",{class:"btn-icon",onClick:p=>j(a.ims,T)},[r(G)],8,wl)])]))),128)),c("div",Vl,[r(me,{modelValue:M.value,"onUpdate:modelValue":m[12]||(m[12]=d=>M.value=d),placement:"auto",align:"top-left-to-bottom-left"},{trigger:g(()=>[r(ne,null,{default:g(()=>[D(i(o.$t("add_field")),1)]),_:1})]),default:g(()=>[c("div",{class:"dropdown-item",onClick:m[7]||(m[7]=()=>R(a.phoneNumbers))},i(o.$t("phone_number")),1),c("div",{class:"dropdown-item",onClick:m[8]||(m[8]=()=>R(a.emails))},i(o.$t("email")),1),c("div",{class:"dropdown-item",onClick:m[9]||(m[9]=()=>R(a.addresses))},i(o.$t("address")),1),c("div",{class:"dropdown-item",onClick:m[10]||(m[10]=()=>R(a.websites))},i(o.$t("website")),1),c("div",{class:"dropdown-item",onClick:m[11]||(m[11]=()=>R(a.ims))},i(o.$t("im")),1)]),_:1},8,["modelValue"])]),c("div",Tl,[r(v,{modelValue:a.notes,"onUpdate:modelValue":m[13]||(m[13]=d=>a.notes=d),type:"textarea",label:o.$t("notes"),rows:3},null,8,["modelValue","label"])])]),actions:g(()=>[r(ne,{value:"cancel",onClick:n(W)},{default:g(()=>[D(i(o.$t("cancel")),1)]),_:1},8,["onClick"]),r(se,{value:"save",loading:n(e)||n(S),onClick:n(X)},{default:g(()=>[D(i(o.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),Nl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Il(q,y){return l(),s("svg",Nl,y[0]||(y[0]=[c("path",{fill:"currentColor",d:"M12 14q.825 0 1.413-.587T14 12t-.587-1.412T12 10t-1.412.588T10 12t.588 1.413T12 14m-4 4h8v-.575q0-.6-.325-1.1t-.9-.75q-.65-.275-1.338-.425T12 15t-1.437.15t-1.338.425q-.575.25-.9.75T8 17.425zm10 4H6q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h7.175q.4 0 .763.15t.637.425l4.85 4.85q.275.275.425.638t.15.762V20q0 .825-.587 1.413T18 22m0-2V8.85L13.15 4H6v16zM6 20V4z"},null,-1)]))}const ql=re({name:"material-symbols-contact-page-outline-rounded",render:Il}),Ll={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Sl(q,y){return l(),s("svg",Ll,y[0]||(y[0]=[c("path",{fill:"currentColor",d:"M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"},null,-1)]))}const Ul=re({name:"material-symbols-edit",render:Sl}),Ml={class:"actions"},Ue=ee({__name:"ContactActionButtons",props:{item:{}},emits:["deleteItem","edit","addItemToTags"],setup(q,{emit:y}){const f=q,a=y;function h(){a("deleteItem",f.item)}function M(){a("edit",f.item)}function L(){a("addItemToTags",f.item)}return(A,e)=>{const _=ge,k=he,S=Ul,N=Oe,E=be("tooltip");return l(),s("div",Ml,[O((l(),V(k,{onClick:F(h,["stop"])},{default:g(()=>[r(_)]),_:1})),[[E,A.$t("delete")]]),O((l(),V(k,{onClick:F(M,["stop"])},{default:g(()=>[r(S)]),_:1})),[[E,A.$t("edit")]]),O((l(),V(k,{onClick:F(L,["stop"])},{default:g(()=>[r(N)]),_:1})),[[E,A.$t("add_to_tags")]])])}}}),Al={class:"start"},El={class:"number"},Dl=["src"],Fl={class:"title"},zl={class:"subtitle"},Bl={key:0},Pl={class:"info"},Ol={class:"list-unstyled"},Rl={class:"time"},Kl=["src"],Ql={class:"subtitle"},jl={key:0},Hl={class:"info"},Gl={class:"list-unstyled"},Jl={class:"time"},Wl=ee({__name:"ContactListItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},dataType:{},callLoading:{type:Boolean},callId:{},callIndex:{},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function}},emits:["deleteItem","edit","addItemToTags","call"],setup(q,{emit:y}){const f=y;function a(e){f("deleteItem",e)}function h(e){f("edit",e)}function M(e){f("addItemToTags",e)}function L(e,_,k){f("call",e,_,k)}function A(e){let _="";ue(e.firstName)||ue(e.lastName)?_=`${e.lastName}${e.middleName}${e.firstName}`:_=[e.firstName,e.middleName,e.lastName].filter(N=>N).join(" ");const k=e.suffix?`, ${e.suffix}`:"",S=`${e.prefix} ${_} ${k}`.trim();return S||(e.emails.length?e.emails[0].value:"")}return(e,_)=>{const k=Qe,S=Gt,N=ql,E=gt,K=Ht,te=he,z=jt,I=be("tooltip");return e.isPhone?(l(),V(z,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:_[4]||(_[4]=t=>e.handleItemClick(t,e.item,e.index,()=>{})),onMouseenter:_[5]||(_[5]=F(t=>e.handleMouseOver(t,e.index),["stop"])),onCheckboxClick:_[6]||(_[6]=t=>e.toggleSelect(t,e.item,e.index))},{image:g(()=>[e.item.thumbnailId?(l(),s("img",{key:0,class:"image",src:n(Ne)(e.item.thumbnailId),width:"50"},null,8,Kl)):(l(),V(N,{key:1,class:"image"}))]),title:g(()=>[D(i(A(e.item)),1)]),subtitle:g(()=>[c("div",Ql,[e.item.notes?(l(),s("span",jl,i(e.item.notes),1)):U("",!0),r(E,{tags:e.item.tags,type:e.dataType,"only-links":!0},null,8,["tags","type"])]),c("div",Hl,[c("ul",Gl,[(l(!0),s($,null,w(e.item.phoneNumbers,(t,C)=>(l(),s("li",{key:C,class:"phone-number"},[D(i(t.type>0?e.$t(`contact.phone_number_type.${t.type}`):t.label)+" "+i(t.normalizedNumber||t.value)+" ",1),O((l(),V(te,{loading:e.callLoading&&e.callId===e.item.id&&e.callIndex===C,onClick:F(R=>L(e.item.id,t.normalizedNumber||t.value,C),["stop"])},{default:g(()=>[r(K)]),_:2},1032,["loading","onClick"])),[[I,e.$t("make_a_phone_call")]])]))),128)),(l(!0),s($,null,w(e.item.emails,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.email_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s($,null,w(e.item.addresses,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.address_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s($,null,w(e.item.websites,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.website_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s($,null,w(e.item.ims,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.im_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s($,null,w(e.item.events,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.event_type.${t.type}`):t.label)+" "+i(t.value),1))),128))])]),c("div",Jl,[O((l(),s("span",null,[D(i(n(qe)(e.item.updatedAt)),1)])),[[I,n(Ie)(e.item.updatedAt)]])])]),actions:g(()=>[r(Ue,{item:e.item,onDeleteItem:a,onEdit:h,onAddItemToTags:M},null,8,["item"])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(l(),s("section",{key:0,class:Re(["contact-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:_[2]||(_[2]=F(t=>e.handleItemClick(t,e.item,e.index,()=>{}),["stop"])),onMouseenter:_[3]||(_[3]=F(t=>e.handleMouseOver(t,e.index),["stop"]))},[c("div",Al,[e.shiftEffectingIds.includes(e.item.id)?(l(),V(k,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:_[0]||(_[0]=F(t=>e.toggleSelect(t,e.item,e.index),["stop"]))},null,8,["checked"])):(l(),V(k,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:_[1]||(_[1]=F(t=>e.toggleSelect(t,e.item,e.index),["stop"]))},null,8,["checked"])),c("span",El,[r(S,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),e.item.thumbnailId?(l(),s("img",{key:0,class:"image",src:n(Ne)(e.item.thumbnailId),width:"50"},null,8,Dl)):(l(),V(N,{key:1,class:"image"})),c("div",Fl,i(A(e.item)),1),c("div",zl,[e.item.notes?(l(),s("span",Bl,i(e.item.notes),1)):U("",!0),r(E,{tags:e.item.tags,type:e.dataType,"only-links":!0},null,8,["tags","type"])]),c("div",Pl,[c("ul",Ol,[(l(!0),s($,null,w(e.item.phoneNumbers,(t,C)=>(l(),s("li",{key:C,class:"phone-number"},[D(i(t.type>0?e.$t(`contact.phone_number_type.${t.type}`):t.label)+" "+i(t.normalizedNumber||t.value)+" ",1),O((l(),V(te,{loading:e.callLoading&&e.callId===e.item.id&&e.callIndex===C,onClick:F(R=>L(e.item.id,t.normalizedNumber||t.value,C),["stop"])},{default:g(()=>[r(K)]),_:2},1032,["loading","onClick"])),[[I,e.$t("make_a_phone_call")]])]))),128)),(l(!0),s($,null,w(e.item.emails,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.email_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s($,null,w(e.item.addresses,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.address_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s($,null,w(e.item.websites,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.website_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s($,null,w(e.item.ims,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.im_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s($,null,w(e.item.events,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.event_type.${t.type}`):t.label)+" "+i(t.value),1))),128))])]),r(Ue,{item:e.item,onDeleteItem:a,onEdit:h,onAddItemToTags:M},null,8,["item"]),c("div",Rl,[O((l(),s("span",null,[D(i(n(qe)(e.item.updatedAt)),1)])),[[I,n(Ie)(e.item.updatedAt)]])])],34))}}}),Xl=Ke(Wl,[["__scopeId","data-v-a4d9bd26"]]),Yl={class:"top-app-bar"},Zl={class:"title"},xl={key:0},eo={key:1},to={class:"actions"},lo={class:"scroll-content"},oo={key:0,class:"no-data-placeholder"},x=50,no=ee({__name:"ContactsView",setup(q){const y=Mt("isPhone"),f=bt(),{app:a}=ht($t()),h=P([]),{t:M}=Pe(),{parseQ:L}=Bt(),A=Be({tagIds:[]}),e=kt.CONTACT,_=At(),k=P(1),S=P([]),N=P(""),{tags:E,fetch:K}=Kt(e),{addToTags:te}=Qt(e,E),{deleteItems:z}=dt(Pt,()=>{X(),p(),Y.emit("refetch_tags",e)}),{selectedIds:I,allChecked:t,realAllChecked:C,selectRealAll:R,allCheckedAlertVisible:j,clearSelection:X,toggleAllChecked:o,toggleSelect:m,total:v,checked:Q,shiftEffectingIds:ce,handleItemClick:H,handleMouseOver:G,selectAll:ne,shouldSelect:me}=ut(h),se=u=>{const b=_.query.q;Et(f,b?`/contacts?page=${u}&q=${b}`:`/contacts?page=${u}`)},{keyDown:ae,keyUp:d}=rt(v,x,k,ne,X,se,()=>{z(I.value,C.value,v.value,N.value)}),{loading:T,fetch:p}=Ct({handle:(u,b)=>{b?Le(M(b),"error"):u&&(h.value=u.contacts,v.value=u.contactCount)},document:qt,variables:()=>({offset:(k.value-1)*x,limit:x,query:N.value})});wt({handle:(u,b)=>{b?Le(M(b),"error"):u&&(S.value=u.contactSources)},document:Lt,variables:null});const $e=u=>{u.type===e&&(X(),p())},ke=u=>{u.type===e&&p()};function je(u){de(Dt,{type:e,tags:E.value,item:{key:u.id,title:"",size:0},selected:E.value.filter(b=>u.tags.some(B=>B.id===b.id))})}function He(u){let b="";ue(u.firstName)||ue(u.lastName)?b=`${u.lastName}${u.middleName}${u.firstName}`:b=[u.firstName,u.middleName,u.lastName].filter(le=>le).join(" ");const B=u.suffix?`, ${u.suffix}`:"",ie=`${u.prefix} ${b} ${B}`.trim();return ie||(u.emails.length?u.emails[0].value:"")}function Ge(u){de(Ft,{id:u.id,name:He(u),gql:fe`
      mutation DeleteContact($query: String!) {
        deleteContacts(query: $query)
      }
    `,variables:()=>({query:`ids:${u.id}`}),typeName:"Contact",done:()=>{v.value--,u.tags.length&&Y.emit("refetch_tags",e)}})}function Je(u){de(Se,{data:u,sources:S,done:p})}function We(){de(Se,{data:null,sources:S,done:p})}const Ce=P(""),we=P(0),{mutate:Xe,loading:Ye}=ve({document:St});function Ze(u,b,B){Ce.value=u,we.value=B,Xe({number:b})}const pe=P(!1);function Ve(){var b,B;const u=parseInt(((b=_.query.page)==null?void 0:b.toString())??"1");k.value=Number.isFinite(u)&&u>0?u:1,N.value=zt(((B=_.query.q)==null?void 0:B.toString())??""),L(A,N.value),p()}return Vt(()=>_.fullPath,()=>{pe.value&&Ve()}),Tt(()=>{K(),pe.value=!0,Ve(),Y.on("item_tags_updated",ke),Y.on("items_tags_updated",$e),window.addEventListener("keydown",ae),window.addEventListener("keyup",d)}),Nt(()=>{pe.value=!1,Y.off("item_tags_updated",ke),Y.off("items_tags_updated",$e),window.removeEventListener("keydown",ae),window.removeEventListener("keyup",d)}),(u,b)=>{const B=Qe,ie=ge,le=he,xe=Ut,et=Oe,tt=ye,lt=Ot,ot=Yt,nt=at,_e=be("tooltip");return l(),s($,null,[c("div",Yl,[r(B,{"touch-target":"wrapper",checked:n(t),indeterminate:!n(t)&&n(Q),onChange:n(o)},null,8,["checked","indeterminate","onChange"]),c("div",Zl,[n(I).length?(l(),s("span",xl,i(u.$t("x_selected",{count:n(C)?n(v).toLocaleString():n(I).length.toLocaleString()})),1)):(l(),s("span",eo,i(u.$t("page_title.contacts"))+" ("+i(n(v).toLocaleString())+")",1)),n(Q)?(l(),s($,{key:2},[O((l(),V(le,{onClick:b[0]||(b[0]=F(J=>n(z)(n(I),n(C),n(v),N.value),["stop"]))},{default:g(()=>[r(ie)]),_:1})),[[_e,u.$t("delete")]]),O((l(),V(le,{style:{display:"none"}},{default:g(()=>[r(xe)]),_:1})),[[_e,u.$t("download")]]),O((l(),V(le,{onClick:b[1]||(b[1]=F(J=>n(te)(n(I),n(C),N.value),["stop"]))},{default:g(()=>[r(et)]),_:1})),[[_e,u.$t("add_to_tags")]])],64)):U("",!0)]),c("div",to,[r(tt,{class:"btn-sm",onClick:We},{default:g(()=>[D(i(u.$t("create")),1)]),_:1})])]),r(lt,{limit:x,total:n(v),"all-checked-alert-visible":n(j),"real-all-checked":n(C),"select-real-all":n(R),"clear-selection":n(X)},null,8,["total","all-checked-alert-visible","real-all-checked","select-real-all","clear-selection"]),c("div",lo,[c("div",{class:Re(["main-list",{"select-mode":n(Q)}])},[(l(!0),s($,null,w(h.value,(J,st)=>(l(),V(Xl,{key:J.id,item:J,index:st,"selected-ids":n(I),"shift-effecting-ids":n(ce),"should-select":n(me),"is-phone":n(y),"data-type":n(e),"call-loading":n(Ye),"call-id":Ce.value,"call-index":we.value,"handle-item-click":n(H),"handle-mouse-over":n(G),"toggle-select":n(m),onDeleteItem:Ge,onEdit:Je,onAddItemToTags:je,onCall:Ze},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","data-type","call-loading","call-id","call-index","handle-item-click","handle-mouse-over","toggle-select"]))),128)),n(T)&&h.value.length===0?(l(),s($,{key:0},w(20,J=>r(ot,{key:J,index:J,"is-phone":n(y)},null,8,["index","is-phone"])),64)):U("",!0)],2),!n(T)&&h.value.length===0?(l(),s("div",oo,i(u.$t(n(It)(n(T),n(a).permissions,"WRITE_CONTACTS"))),1)):U("",!0),n(v)>x?(l(),V(nt,{key:1,page:k.value,go:se,total:n(v),limit:x},null,8,["page","total"])):U("",!0)])],64)}}}),fo=Ke(no,[["__scopeId","data-v-3094d28c"]]);export{fo as default};
