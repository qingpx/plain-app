import{m as x,c as d,o as s,a as n,d as X,u as ee,r as T,g as te,c7 as ge,H as A,i as U,c8 as ye,aG as P,M as m,x as i,j as r,an as ne,k as c,J as p,t as l,C as oe,a0 as E,a1 as $e,R as be,aI as we,Z as ke,$ as Ce,h as B,O as b,P as Me,v as Ve,am as Se,c9 as Le,au as ze,I as Ie,al as Qe,ca as He,cb as De,cc as Be,cd as xe,bG as Ge,ce as Re,cf as Ae,a5 as Ue,cg as Ee,a7 as R,L as Fe}from"./index-D87Nr3Nw.js";import{_ as Ne}from"./more-vert-BNcWbRGO.js";import{_ as Oe}from"./VSelect-DFeZ-vdS.js";const Pe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function je(M,o){return s(),d("svg",Pe,o[0]||(o[0]=[n("path",{fill:"currentColor",d:"M12 17.5q1.875 0 3.188-1.312T16.5 13t-1.312-3.187T12 8.5T8.813 9.813T7.5 13t1.313 3.188T12 17.5m0-2q-1.05 0-1.775-.725T9.5 13t.725-1.775T12 10.5t1.775.725T14.5 13t-.725 1.775T12 15.5M4 21q-.825 0-1.412-.587T2 19V7q0-.825.588-1.412T4 5h3.15L8.4 3.65q.275-.3.663-.475T9.875 3h4.25q.425 0 .813.175t.662.475L16.85 5H20q.825 0 1.413.588T22 7v12q0 .825-.587 1.413T20 21z"},null,-1)]))}const Je=x({name:"material-symbols-photo-camera-rounded",render:je}),We={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ye(M,o){return s(),d("svg",We,o[0]||(o[0]=[n("path",{fill:"currentColor",d:"M12 21q-.425 0-.712-.288T11 20v-4q0-.425.288-.712T12 15t.713.288T13 16v1h7q.425 0 .713.288T21 18t-.288.713T20 19h-7v1q0 .425-.288.713T12 21m-8-2q-.425 0-.712-.288T3 18t.288-.712T4 17h4q.425 0 .713.288T9 18t-.288.713T8 19zm4-4q-.425 0-.712-.288T7 14v-1H4q-.425 0-.712-.288T3 12t.288-.712T4 11h3v-1q0-.425.288-.712T8 9t.713.288T9 10v4q0 .425-.288.713T8 15m4-2q-.425 0-.712-.288T11 12t.288-.712T12 11h8q.425 0 .713.288T21 12t-.288.713T20 13zm4-4q-.425 0-.712-.288T15 8V4q0-.425.288-.712T16 3t.713.288T17 4v1h3q.425 0 .713.288T21 6t-.288.713T20 7h-3v1q0 .425-.288.713T16 9M4 7q-.425 0-.712-.288T3 6t.288-.712T4 5h8q.425 0 .713.288T13 6t-.288.713T12 7z"},null,-1)]))}const Ze=x({name:"material-symbols-tune-rounded",render:Ye}),Ke={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xe(M,o){return s(),d("svg",Ke,o[0]||(o[0]=[n("path",{fill:"currentColor",d:"M6 18H4q-.425 0-.712-.288T3 17t.288-.712T4 16h3q.425 0 .713.288T8 17v3q0 .425-.288.713T7 21t-.712-.288T6 20zm12 0v2q0 .425-.288.713T17 21t-.712-.288T16 20v-3q0-.425.288-.712T17 16h3q.425 0 .713.288T21 17t-.288.713T20 18zM6 6V4q0-.425.288-.712T7 3t.713.288T8 4v3q0 .425-.288.713T7 8H4q-.425 0-.712-.288T3 7t.288-.712T4 6zm12 0h2q.425 0 .713.288T21 7t-.288.713T20 8h-3q-.425 0-.712-.288T16 7V4q0-.425.288-.712T17 3t.713.288T18 4z"},null,-1)]))}const et=x({name:"material-symbols-fullscreen-exit-rounded",render:Xe}),tt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function nt(M,o){return s(),d("svg",tt,o[0]||(o[0]=[n("path",{fill:"currentColor",d:"M5 19h2q.425 0 .713.288T8 20t-.288.713T7 21H4q-.425 0-.712-.288T3 20v-3q0-.425.288-.712T4 16t.713.288T5 17zm14 0v-2q0-.425.288-.712T20 16t.713.288T21 17v3q0 .425-.288.713T20 21h-3q-.425 0-.712-.288T16 20t.288-.712T17 19zM5 5v2q0 .425-.288.713T4 8t-.712-.288T3 7V4q0-.425.288-.712T4 3h3q.425 0 .713.288T8 4t-.288.713T7 5zm14 0h-2q-.425 0-.712-.288T16 4t.288-.712T17 3h3q.425 0 .713.288T21 4v3q0 .425-.288.713T20 8t-.712-.288T19 7z"},null,-1)]))}const ot=x({name:"material-symbols-fullscreen-rounded",render:nt}),st={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function at(M,o){return s(),d("svg",st,o[0]||(o[0]=[n("path",{fill:"currentColor",d:"M6 16V8q0-.825.588-1.412T8 6h8q.825 0 1.413.588T18 8v8q0 .825-.587 1.413T16 18H8q-.825 0-1.412-.587T6 16"},null,-1)]))}const lt=x({name:"material-symbols-stop-rounded",render:at}),rt={xmlns:"http://www.w3.org/2000/svg",viewBox:"176.31 -11.19 346.88 581.88"};function it(M,o){return s(),d("svg",rt,o[0]||(o[0]=[n("path",{d:"M470.49 0H229.51a41.9 41.9 0 0 0-29.547 12.277 41.9 41.9 0 0 0-12.277 29.547v476.35a41.9 41.9 0 0 0 12.277 29.547 41.9 41.9 0 0 0 29.547 12.277h240.98a41.9 41.9 0 0 0 29.547-12.277 41.9 41.9 0 0 0 12.277-29.547V41.824a41.9 41.9 0 0 0-12.277-29.547A41.9 41.9 0 0 0 470.49 0m33.25 518.18a33.33 33.33 0 0 1-9.766 23.484 33.34 33.34 0 0 1-23.484 9.766H229.51a33.33 33.33 0 0 1-23.484-9.766 33.34 33.34 0 0 1-9.765-23.484V41.83a33.33 33.33 0 0 1 9.828-23.371 33.32 33.32 0 0 1 23.422-9.703h240.98a33.33 33.33 0 0 1 23.484 9.765 33.34 33.34 0 0 1 9.765 23.484z"},null,-1),n("path",{d:"M317.62 46.812h64.75c2.418 0 4.375-1.957 4.375-4.375s-1.957-4.375-4.375-4.375h-64.75c-2.418 0-4.375 1.957-4.375 4.375s1.957 4.375 4.375 4.375M364.7 192.5a16.8 16.8 0 0 0-14.7-8.75 16.8 16.8 0 0 0-14.698 8.75l-91 157.5a16.45 16.45 0 0 0 0 16.977 16.6 16.6 0 0 0 6.101 6.386 16.65 16.65 0 0 0 8.512 2.364h182.09a16.626 16.626 0 0 0 14.7-8.75 16.8 16.8 0 0 0 0-16.977zm83.562 170.36a8.22 8.22 0 0 1-7.262 4.2H258.91a8.23 8.23 0 0 1-7.176-4.2 8.75 8.75 0 0 1 0-8.75l91-157.5a8.75 8.75 0 0 1 7.262-4.113 8.76 8.76 0 0 1 7.262 4.199l91 157.5a8.75 8.75 0 0 1 0 8.84z"},null,-1),n("path",{d:"M350 221.55a4.29 4.29 0 0 0-4.29 4.285v66.238a4.375 4.375 0 0 0 8.75 0v-66.238a4.286 4.286 0 0 0-4.46-4.285m0 91.26a4.29 4.29 0 0 0-4.29 4.29v17.061a4.375 4.375 0 0 0 8.75 0V317.1a4.286 4.286 0 0 0-4.46-4.29"},null,-1)]))}const ut={render:it},ct={class:"form-row"},dt={class:"button-group"},_t=["onClick"],mt={class:"form-row"},vt={class:"form-label"},pt={class:"form-row"},ft={class:"form-label"},ht={class:"form-row",style:{"max-width":"640px"}},Tt=X({__name:"ChangeScreenMirrorQualityModal",setup(M){const{t:o}=ee(),f=T(720),q=T(60),_=T("quality_sd"),g=[{id:"quality_ld",data:{resolution:480,quality:50}},{id:"quality_sd",data:{resolution:720,quality:50}},{id:"quality_hd",data:{resolution:1080,quality:50}},{id:"custom"}],w=[10,20,30,40,50,60,70,80,90,100],y=[480,720,1080];te({handle:(a,h)=>{var V;h?A(o(h),"error"):a&&(f.value=a.screenMirrorQuality.resolution,q.value=a.screenMirrorQuality.quality,_.value=((V=g.find(S=>{var L,I;return((L=S.data)==null?void 0:L.resolution)===f.value&&((I=S.data)==null?void 0:I.quality)===q.value}))==null?void 0:V.id)||"custom")},document:ge});function z(a){return a===10?`10 (${o("low_quality")})`:a===60?`60 (${o("high_quality")})`:a===100?`100 (${o("best_quality")})`:a.toString()}function H(a){_.value=a.id,a.data&&(f.value=a.data.resolution,q.value=a.data.quality)}const{mutate:k,loading:G,onDone:$}=U({document:ye});$(()=>{P()});const F=()=>{k({resolution:f.value,quality:q.value})};return(a,h)=>{const V=Oe,S=ne,L=oe,I=we;return s(),m(I,{"modal-id":"screen-mirror-quality",onClose:c(P)},{headline:i(()=>[p(l(a.$t("change_quality")),1)]),content:i(()=>[n("div",ct,[n("div",dt,[(s(),d(E,null,$e(g,u=>n("button",{key:u.id,class:be({selected:_.value===u.id}),onClick:j=>H(u)},l(a.$t(u.id)),11,_t)),64))])]),n("div",mt,[n("label",vt,l(a.$t("compress_quality")),1),r(V,{modelValue:q.value,"onUpdate:modelValue":h[0]||(h[0]=u=>q.value=u),modelModifiers:{number:!0},class:"flex-2",disabled:_.value!=="custom",options:w.map(u=>({value:u,label:z(u)}))},null,8,["modelValue","disabled","options"])]),n("div",pt,[n("label",ft,l(a.$t("resolution")),1),r(V,{modelValue:f.value,"onUpdate:modelValue":h[1]||(h[1]=u=>f.value=u),modelModifiers:{number:!0},class:"flex-2",disabled:_.value!=="custom",options:y.map(u=>({value:u,label:`${u}p`}))},null,8,["modelValue","disabled","options"])]),n("div",ht,l(a.$t("screen_mirror_quality_tips")),1)]),actions:i(()=>[r(S,{value:"cancel",onClick:c(P)},{default:i(()=>[p(l(a.$t("cancel")),1)]),_:1},8,["onClick"]),r(L,{value:"save",loading:c(G),onClick:F},{default:i(()=>[p(l(a.$t("save")),1)]),_:1},8,["loading"])]),_:1},8,["onClose"])}}}),qt={class:"screen-mirror"},gt={class:"top-app-bar"},yt={class:"title"},$t={class:"actions"},bt={class:"content"},wt={key:0},kt={key:0,class:"request-permission"},Ct={class:"tap-phone"},Mt={class:"text"},Vt={key:1,class:"request-permission-failed"},St=X({__name:"ScreenMirrorView",setup(M){let o;const{t:f}=ee(),q=Ve("isPhone"),_=T(!1),g=T(0),w=T(!1),y=T(!1),z=T(!1),H=T(),k=T(!1),G=async e=>{_.value=!0,I(e),w.value=!1,g.value=0,clearInterval(o)};let $=!1;const{mutate:F}=U({document:He}),a=()=>{y.value=!y.value,y.value||J()},h=()=>{Ue(Tt)},V=()=>{F(),$=!0},S=e=>{e&&$&&($=!1,clearInterval(o),N())},L=()=>{const e=H.value;if(!e)return;const t=new Date,Q="screenshot-"+[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()].join("")+".png";Ee(e.toDataURL(),Q)};function I(e){const t=H.value;if(!t||y.value&&!z.value)return;z.value=!1;const Q=t.getContext("2d"),v=new Image;v.src=URL.createObjectURL(e),v.onload=function(){Q&&(t.width=v.width,t.height=v.height,Q.drawImage(v,0,0))}}ke(()=>{R.on("screen_mirroring",G),R.on("app_socket_connection_changed",S)}),Ce(()=>{R.off("screen_mirroring",G),R.off("app_socket_connection_changed",S)});const{mutate:u,loading:j,onDone:se,onError:ae}=U({document:De}),{loading:le,refetch:J}=te({handle:(e,t)=>{t?A(f(t),"error"):e.screenMirrorState?(_.value=!0,z.value=!0):(_.value=!1,z.value=!1,N())},options:{fetchPolicy:"no-cache"},document:Be}),W=()=>{document.getElementsByClassName("screen-mirror")[0].requestFullscreen({navigationUI:"show"})},N=()=>{w.value=!1,y.value=!1,u()},Y=()=>{document.exitFullscreen()};ae(e=>{A(f(e.message)),w.value=!0}),se(()=>{g.value=30,o=setInterval(()=>{g.value--,g.value<=0&&(w.value=!0,clearInterval(o))},1e3)});const{mutate:re,loading:ie,onDone:ue,onError:ce}=U({document:xe});return ce(e=>{A(f(e.message))}),ue(()=>{w.value=!0,_.value=!1}),(e,t)=>{const Q=Ge,v=Ie,de=Re,_e=Ae,me=lt,O=ne,Z=ot,K=et,ve=Ne,pe=Ze,fe=Je,he=Qe,Te=Se,qe=oe,C=Me("tooltip");return s(),d("div",qt,[n("div",gt,[n("div",yt,l(e.$t("screen_mirror")),1),n("div",$t,[_.value?(s(),d(E,{key:0},[b((s(),m(v,{onClick:t[0]||(t[0]=()=>c(J)())},{default:i(()=>[r(Q)]),_:1})),[[C,e.$t("refresh")]]),b((s(),m(v,{onClick:a},{default:i(()=>[y.value?(s(),m(de,{key:0})):(s(),m(_e,{key:1}))]),_:1})),[[C,e.$t(y.value?"resume":"pause")]]),b((s(),m(v,{disabled:c(ie),class:"btn-stop",onClick:c(re)},{default:i(()=>[r(me)]),_:1},8,["disabled","onClick"])),[[C,e.$t("stop_mirror")]]),c(q)?B("",!0):(s(),d(E,{key:0},[b((s(),m(O,{class:"btn-sm",onClick:h},{default:i(()=>[p(l(e.$t("mirror_quality")),1)]),_:1})),[[C,e.$t("change_quality")]]),b((s(),m(O,{class:"btn-sm",onClick:L},{default:i(()=>[p(l(e.$t("screenshot")),1)]),_:1})),[[C,e.$t("screenshot")]]),b((s(),m(v,{class:"btn-enter-fullscreen",onClick:W},{default:i(()=>[r(Z)]),_:1})),[[C,e.$t("fullscreen")]]),b((s(),m(v,{class:"btn-exit-fullscreen",onClick:Y},{default:i(()=>[r(K)]),_:1})),[[C,e.$t("exit_fullscreen")]])],64)),c(q)?(s(),m(he,{key:1,modelValue:k.value,"onUpdate:modelValue":t[5]||(t[5]=D=>k.value=D)},{trigger:i(()=>[b((s(),m(v,null,{default:i(()=>[r(ve)]),_:1})),[[C,e.$t("settings")]])]),default:i(()=>[n("div",{class:"dropdown-item",onClick:t[1]||(t[1]=D=>{h(),k.value=!1})},[r(pe),p(" "+l(e.$t("mirror_quality")),1)]),n("div",{class:"dropdown-item",onClick:t[2]||(t[2]=D=>{L(),k.value=!1})},[r(fe),p(" "+l(e.$t("screenshot")),1)]),n("div",{class:"dropdown-item enter-fullscreen",onClick:t[3]||(t[3]=D=>{W(),k.value=!1})},[r(Z),p(" "+l(e.$t("fullscreen")),1)]),n("div",{class:"dropdown-item exit-fullscreen",onClick:t[4]||(t[4]=D=>{Y(),k.value=!1})},[r(K),p(" "+l(e.$t("exit_fullscreen")),1)])]),_:1},8,["modelValue"])):B("",!0)],64)):c($)?B("",!0):(s(),m(O,{key:1,class:"btn-sm",onClick:V},{default:i(()=>[p(l(e.$t("relaunch_app")),1)]),_:1}))])]),n("div",bt,[c(le)||c(j)||c($)?(s(),d("div",wt,[r(Te,{indeterminate:""})])):(s(),d(E,{key:1},[g.value>0&&!c($)?(s(),d("div",kt,[n("div",Ct,[r(c(Le))]),n("pre",Mt,l(e.$t("screen_mirror_request_permission",{seconds:g.value})),1)])):B("",!0),w.value&&!_.value&&!c($)?(s(),d("div",Vt,[r(c(ut)),n("p",null,l(e.$t("screen_mirror_request_permission_failed")),1),r(qe,{onClick:N},{default:i(()=>[p(l(e.$t("try_again")),1)]),_:1})])):B("",!0),b(n("canvas",{ref_key:"canvasRef",ref:H,class:"canvas"},null,512),[[ze,_.value]])],64))])])}}}),Qt=Fe(St,[["__scopeId","data-v-644b091c"]]);export{Qt as default};
