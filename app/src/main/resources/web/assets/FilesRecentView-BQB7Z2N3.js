import{_ as be}from"./ListItemPhone.vuevuetypescriptsetuptruelang-CYRT3CJ2.js";import{d as R,c as a,M as u,o,B as p,R as $e,a as l,j as f,bF as D,k as t,aL as J,t as r,O as y,q as W,P as q,U as X,J as P,V as Y,I as x,x as c,ao as ee,bE as Fe,b_ as Ce,L as se,N as Se,u as De,r as C,f as Le,s as Te,i as Ve,aA as Ae,Y as Pe,Z as Re,$ as Be,h as S,a0 as Z,a1 as Me,c2 as Ne,bx as Oe,a2 as Ue,bQ as ze,c3 as Ke,H as j,bP as He,bU as Qe,ax as Ge,bV as Je,bW as We,a5 as Xe,a7 as I,bX as Ye,bY as Ze}from"./index-D87Nr3Nw.js";import{_ as je}from"./FieldId.vuevuetypescriptsetuptruelang-DRoBQnQY.js";import{_ as te}from"./VCheckbox-CrJS-AL3.js";import{_ as qe,u as xe,c as es}from"./key-events-CGCvIZ4E.js";import{_ as ss}from"./DownloadMethodModal.vuevuetypescriptsetuptruelang-mQ3k85bt.js";const ts={class:"start"},ns={class:"number"},os={key:0,class:"svg",src:D},is=["src"],ls=["src"],as={key:3,class:"svg",src:D},ds={class:"title"},rs={class:"subtitle"},cs={class:"actions"},ms={class:"card card-info"},us={class:"key-value vertical"},ps={class:"key"},fs={class:"value"},vs={key:0,class:"svg",src:D},gs=["src"],hs=["src"],ks={key:3,class:"svg",src:D},_s={class:"actions"},ys={class:"card card-info"},Is={class:"key-value vertical"},ws={class:"key"},Es={class:"value"},bs=R({__name:"FileRecentItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},imageErrorIds:{},extensionImageErrorIds:{},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function},onImageError:{type:Function},onExtensionImageError:{type:Function},downloadFile:{type:Function},clickItem:{type:Function}},setup(B){return(e,s)=>{const g=te,w=je,E=ee,h=x,m=Fe,k=Ce,b=be,_=q("tooltip");return e.isPhone?(o(),u(b,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:s[12]||(s[12]=i=>e.handleItemClick(i,e.item,e.index,()=>e.clickItem(e.item))),onMouseenter:s[13]||(s[13]=p(i=>e.handleMouseOver(i,e.index),["stop"])),onCheckboxClick:s[14]||(s[14]=i=>e.toggleSelect(i,e.item,e.index))},{image:c(()=>[l("div",{class:"image",onClick:s[10]||(s[10]=p(i=>e.clickItem(e.item),["stop"]))},[e.extensionImageErrorIds.includes(e.item.id)?(o(),a("img",vs)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),a("img",{key:1,class:"image-thumb",src:t(J)(e.item.fileId,"&w=50&h=50"),onError:s[8]||(s[8]=i=>e.onImageError(e.item.id))},null,40,gs)):e.item.extension?(o(),a("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:s[9]||(s[9]=i=>e.onExtensionImageError(e.item.id))},null,40,hs)):(o(),a("img",ks))])]),title:c(()=>[P(r(e.item.name),1)]),subtitle:c(()=>[l("span",null,r(t(W)(e.item.size)),1),y((o(),a("span",null,[P(r(t(Y)(e.item.updatedAt)),1)])),[[_,t(X)(e.item.updatedAt)]])]),actions:c(()=>[l("div",_s,[y((o(),u(h,{onClick:s[11]||(s[11]=p(i=>e.downloadFile(e.item.path),["stop"]))},{default:c(()=>[f(E)]),_:1})),[[_,e.$t("download")]]),f(k,null,{content:c(()=>[l("section",ys,[l("div",Is,[l("div",ws,r(e.$t("path")),1),l("div",Es,r(e.item.path),1)])])]),default:c(()=>[y((o(),u(h,null,{default:c(()=>[f(m)]),_:1})),[[_,e.$t("info")]])]),_:1})])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(o(),a("section",{key:0,class:$e(["file-item recent-file-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:s[6]||(s[6]=p(i=>e.handleItemClick(i,e.item,e.index,()=>e.clickItem(e.item)),["stop"])),onMouseenter:s[7]||(s[7]=p(i=>e.handleMouseOver(i,e.index),["stop"]))},[l("div",ts,[e.shiftEffectingIds.includes(e.item.id)?(o(),u(g,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:s[0]||(s[0]=p(i=>e.toggleSelect(i,e.item,e.index),["stop"]))},null,8,["checked"])):(o(),u(g,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:s[1]||(s[1]=p(i=>e.toggleSelect(i,e.item,e.index),["stop"]))},null,8,["checked"])),l("span",ns,[f(w,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),l("div",{class:"image",onClick:s[4]||(s[4]=p(i=>e.clickItem(e.item),["stop"]))},[e.extensionImageErrorIds.includes(e.item.id)?(o(),a("img",os)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),a("img",{key:1,class:"image-thumb",src:t(J)(e.item.fileId,"&w=50&h=50"),onError:s[2]||(s[2]=i=>e.onImageError(e.item.id))},null,40,is)):e.item.extension?(o(),a("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:s[3]||(s[3]=i=>e.onExtensionImageError(e.item.id))},null,40,ls)):(o(),a("img",as))]),l("div",ds,r(e.item.name),1),l("div",rs,[l("span",null,r(t(W)(e.item.size)),1),y((o(),a("span",null,[P(r(t(Y)(e.item.updatedAt)),1)])),[[_,t(X)(e.item.updatedAt)]])]),l("div",cs,[y((o(),u(h,{onClick:s[5]||(s[5]=p(i=>e.downloadFile(e.item.path),["stop"]))},{default:c(()=>[f(E)]),_:1})),[[_,e.$t("download")]]),f(k,null,{content:c(()=>[l("section",ms,[l("div",us,[l("div",ps,r(e.$t("path")),1),l("div",fs,r(e.item.path),1)])])]),default:c(()=>[y((o(),u(h,null,{default:c(()=>[f(m)]),_:1})),[[_,e.$t("info")]])]),_:1})])],34))}}}),$s=se(bs,[["__scopeId","data-v-7ca2e29e"]]),Fs={key:0,class:"file-item recent-file-item selectable-card-skeleton"},Cs={class:"start"},Ss={class:"number"},Ds=R({__name:"FileRecentSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(B){return(e,s)=>{const g=qe;return e.isPhone?(o(),u(g,{key:1,"title-width":"60%",subtitles:[{width:"45%"},{width:"40%"}],"action-count":2})):(o(),a("section",Fs,[l("div",Cs,[s[0]||(s[0]=l("div",{class:"skeleton-checkbox"},null,-1)),l("span",Ss,r(e.index),1)]),s[1]||(s[1]=Se('<div class="image" data-v-777f0631><div class="skeleton-image lg" data-v-777f0631></div></div><div class="title" data-v-777f0631><div class="skeleton-text lg" style="width:40%;" data-v-777f0631></div></div><div class="subtitle" data-v-777f0631><div class="skeleton-text" style="width:30%;" data-v-777f0631></div></div><div class="actions" data-v-777f0631><div class="skeleton-text lg" style="width:80px;" data-v-777f0631></div></div>',4))]))}}}),Ls=se(Ds,[["__scopeId","data-v-777f0631"]]),Ts={class:"top-app-bar"},Vs={key:0},As={key:1},Ps={key:0,class:"scroller main-list"},Rs={key:2,class:"no-data-placeholder"},Ks=R({__name:"FilesRecentView",setup(B){const{t:e}=De(),s=C([]),g=Ne(),w=Le(),{app:E,urlTokenKey:h}=Te(w),m=C([]),{selectedIds:k,allChecked:b,realAllChecked:_,clearSelection:i,toggleAllChecked:ne,toggleSelect:oe,total:L,checked:M,shiftEffectingIds:ie,handleItemClick:le,handleMouseOver:ae,selectAll:de,shouldSelect:re}=xe(m),{downloadFile:$,downloadFiles:ce,downloadDir:me}=Ae(h),{view:ue}=We(s,(n,d)=>{w.lightbox={sources:n,index:d,visible:!0}}),{keyDown:N,keyUp:O}=es(de,i,()=>{}),U=C([]),z=C([]),pe=n=>{U.value.push(n)},fe=n=>{z.value.push(n)},{mutate:ve,onDone:ge}=Ve({document:ze});ge(n=>{ce(n.data.setTempValue.key),i()});const he=n=>{Qe(n.name)?window.open(Ge(h.value,n.path),"_blank"):Je(n.name)?ue(m.value,n):$(n.path)},{loading:T,fetch:V}=Pe({handle:async(n,d)=>{if(d)j(e(d),"error");else{const v=[];for(const A of n.recentFiles)v.push(He(A,h.value));m.value=v,L.value=v.length}},document:Ke}),ke=()=>{const n=m.value.filter(d=>k.value.includes(d.id));if(n.length===0){j(e("select_first"),"error");return}if(n.length===1&&!n[0].isDir){$(n[0].path),i();return}Xe(ss,{onEach:async()=>{for(const d of n)d.isDir?me(d.path):$(d.path),await new Promise(v=>setTimeout(v,250));i()},onZip:()=>{ve({key:Ze(),value:JSON.stringify(k.value.map(d=>({path:d})))})}})},K=n=>{n.status==="done"&&setTimeout(()=>{V()},1e3)},_e=n=>{n.forEach(d=>{Ye(m.value,v=>v.id===d.id)}),i()},H=n=>{_e([n.item])},Q=n=>{V()};return Re(()=>{V(),I.on("upload_task_done",K),I.on("file_deleted",H),I.on("file_renamed",Q),window.addEventListener("keydown",N),window.addEventListener("keyup",O)}),Be(()=>{I.off("upload_task_done",K),I.off("file_deleted",H),I.off("file_renamed",Q),window.removeEventListener("keydown",N),window.removeEventListener("keyup",O)}),(n,d)=>{const v=te,A=ee,ye=x,Ie=Ls,we=$s,Ee=q("tooltip");return o(),a(Z,null,[l("div",Ts,[f(v,{"touch-target":"wrapper",checked:t(b),indeterminate:!t(b)&&t(M),onChange:t(ne)},null,8,["checked","indeterminate","onChange"]),t(k).length?(o(),a("span",Vs,r(n.$t("x_selected",{count:t(_)?t(L).toLocaleString():t(k).length.toLocaleString()})),1)):(o(),a("span",As,r(n.$t("recent_files"))+" ("+r(t(L).toLocaleString())+")",1)),t(M)?y((o(),u(ye,{key:2,onClick:p(ke,["stop"])},{default:c(()=>[f(A)]),_:1})),[[Ee,n.$t("download")]]):S("",!0)]),t(T)&&m.value.length===0?(o(),a("div",Ps,[(o(),a(Z,null,Me(20,F=>f(Ie,{key:F,index:F,"is-phone":t(g)},null,8,["index","is-phone"])),64))])):S("",!0),m.value.length>0?(o(),u(t(Oe),{key:1,class:"scroller main-list","data-key":"id","data-sources":m.value,"estimate-size":t(g)?120:80},{item:c(({index:F,item:G})=>[(o(),u(we,{key:G.id,item:G,index:F,"selected-ids":t(k),"shift-effecting-ids":t(ie),"should-select":t(re),"is-phone":t(g),"image-error-ids":U.value,"extension-image-error-ids":z.value,"handle-item-click":t(le),"handle-mouse-over":t(ae),"toggle-select":t(oe),"on-image-error":pe,"on-extension-image-error":fe,"download-file":t($),"click-item":he},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","image-error-ids","extension-image-error-ids","handle-item-click","handle-mouse-over","toggle-select","download-file"]))]),_:1},8,["data-sources","estimate-size"])):S("",!0),!t(T)&&m.value.length===0?(o(),a("div",Rs,r(n.$t(t(Ue)(t(T),t(E).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):S("",!0)],64)}}});export{Ks as default};
