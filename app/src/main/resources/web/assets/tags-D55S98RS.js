import{d as G,aH as N,r as h,aI as j,cz as H,i as C,cA as R,cB as E,M as k,o as m,x as r,j as v,J as f,t as i,k as o,aK as y,an as J,C as K,a as p,O,R as b,c as Y,a1 as Z,cC as x,a0 as P,cD as U,au as W,aL as X,a7 as q,bZ as ee,L as ae,u as $,Y as te,bq as se,H as A,a5 as oe}from"./index-DZ3IxO2v.js";const ne={class:"button-group"},le=G({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(d){const{handleSubmit:_}=N(),t=h("add_to_tags"),a=d,{value:s,errorMessage:n}=j("selectedTags",H().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:l,loading:g,onDone:L}=C({document:R}),{mutate:M,loading:D,onDone:S}=C({document:E}),T=()=>{q.emit("items_tags_updated",{type:a.type}),q.emit("refetch_tags",a.type),y()};S(T),L(T);function B(e){s.value.includes(e)?ee(s.value,u=>u.id===e.id):s.value.push(e)}const F=_(()=>{t.value==="add_to_tags"?M({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query}):l({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query})});return(e,u)=>{const I=x,Q=U,V=J,w=K,z=X;return m(),k(z,{onClose:o(y)},{headline:r(()=>[f(i(e.$t("tags")),1)]),content:r(()=>[p("div",ne,[p("button",{class:b({selected:t.value==="add_to_tags"}),onClick:u[0]||(u[0]=c=>t.value="add_to_tags")},i(e.$t("add_to_tags")),3),p("button",{class:b({selected:t.value==="remove_from_tags"}),onClick:u[1]||(u[1]=c=>t.value="remove_from_tags")},i(e.$t("remove_from_tags")),3)]),v(Q,null,{default:r(()=>[(m(!0),Y(P,null,Z(d.tags,c=>(m(),k(I,{key:c.id,label:c.name,selected:o(s).includes(c),onClick:ue=>B(c)},null,8,["label","selected","onClick"]))),128))]),_:1}),O(p("div",{class:"invalid-feedback"},i(o(n)?e.$t(o(n)):""),513),[[W,o(n)]])]),actions:r(()=>[v(V,{value:"cancel",onClick:o(y)},{default:r(()=>[f(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),v(w,{value:"save",loading:o(D)||o(g),onClick:o(F)},{default:r(()=>[f(i(e.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),de=ae(le,[["__scopeId","data-v-8725492b"]]),re=(d,_)=>{const{t}=$();return{addToTags:(a,s,n)=>{let l=n;if(!s){if(a.length===0){A(t("select_first"),"error");return}l=`ids:${a.join(",")}`}oe(de,{type:d,tags:_.value,query:l})}}},ie=(d,_=()=>{})=>{const t=h([]),{t:a}=$(),{loading:s,fetch:n}=te({handle:async(l,g)=>{g?A(a(g),"error"):l&&(t.value=l.tags,_())},document:se,variables:{type:d}});return{tags:t,loading:s,fetch:n}};export{re as a,ie as u};
